import{A as e}from"./abstract-connector.esm.6ce9aaa9.js";import{i as t}from"./vendor.9ff4bacf.js";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var n={1:"mainnet",3:"ropsten",4:"rinkeby",5:"goerli",42:"kovan",100:"xdai",30:"orchid",31:"orchidTestnet",99:"core",77:"sokol",61:"classic",8:"ubiq",108:"thundercore",18:"thundercoreTestnet",163:"lightstreams",122:"fuse",15001:"maticTestnet"},o=function(e){var o,i;function c(o){var i,c=o.dAppId,s=o.networks,a=o.config,u=void 0===a?{}:a,h=s.map((function(e){return"number"==typeof e?e:Number(e.chainId)}));return h.every((function(e){return!!n[e]}))||t(!1),(i=e.call(this,{supportedChainIds:h})||this).dAppId=c,i.networks=s,i.config=u,i.handleOnLogout=i.handleOnLogout.bind(r(i)),i.handleOnActiveWalletChanged=i.handleOnActiveWalletChanged.bind(r(i)),i.handleOnError=i.handleOnError.bind(r(i)),i}i=e,(o=c).prototype=Object.create(i.prototype),o.prototype.constructor=o,o.__proto__=i;var s=c.prototype;return s.handleOnLogout=function(){this.emitDeactivate()},s.handleOnActiveWalletChanged=function(e){this.emitUpdate({account:e})},s.handleOnError=function(e){this.emitError(e)},s.activate=function(){try{var e=function(){return t.portis.onLogout(t.handleOnLogout),t.portis.onActiveWalletChanged(t.handleOnActiveWalletChanged),t.portis.onError(t.handleOnError),Promise.resolve(t.portis.provider.enable().then((function(e){return e[0]}))).then((function(e){return{provider:t.portis.provider,account:e}}))},t=this,r=function(){if(!t.portis)return Promise.resolve(import("./index.b0c573b4.js").then((function(e){var t;return null!=(t=null==e?void 0:e.default)?t:e}))).then((function(e){t.portis=new e(t.dAppId,"number"==typeof t.networks[0]?n[t.networks[0]]:t.networks[0],t.config)}))}();return Promise.resolve(r&&r.then?r.then(e):e())}catch(o){return Promise.reject(o)}},s.getProvider=function(){try{return Promise.resolve(this.portis.provider)}catch(e){return Promise.reject(e)}},s.getChainId=function(){try{return Promise.resolve(this.portis.provider.send("eth_chainId"))}catch(e){return Promise.reject(e)}},s.getAccount=function(){try{return Promise.resolve(this.portis.provider.send("eth_accounts").then((function(e){return e[0]})))}catch(e){return Promise.reject(e)}},s.deactivate=function(){this.portis.onLogout((function(){})),this.portis.onActiveWalletChanged((function(){})),this.portis.onError((function(){}))},s.changeNetwork=function(e,r){try{var o=this;return"number"==typeof e?(n[e]||t(!1),o.portis.changeNetwork(n[e],r),o.emitUpdate({chainId:e})):(o.portis.changeNetwork(e,r),o.emitUpdate({chainId:Number(e.chainId)})),Promise.resolve()}catch(i){return Promise.reject(i)}},s.close=function(){try{var e=this;return Promise.resolve(e.portis.logout()).then((function(){e.emitDeactivate()}))}catch(t){return Promise.reject(t)}},c}(e);export{o as PortisConnector};
