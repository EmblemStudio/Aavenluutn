import{e}from"./abstract-connector.esm.b8d83b65.js";import{u as t,i as r}from"./immutable.418b4803.js";import{d as n,m as o,e as i,n as a,o as s,s as c,b as u,w as f,i as l,c as h,f as d,a as p}from"./index.b1a58e12.js";import{p as g,e as y,s as v}from"./subscriptionManager.21e8eda2.js";import{j as m,e as w,c as b,k as _,g as x,b as E}from"./index.0d3a7a33.js";import{o as k,n as T,m as A,k as B,a as P}from"./vendor.e2ee514a.js";import"./index.74a5dd83.js";import"./index.f461e206.js";import"./index.ec5d003b.js";const S=e.exports.EventEmitter;var U=M;function M(){S.call(this),this.isLocked=!0}(0,t.inherits)(M,S),M.prototype.go=function(){this.isLocked=!1,this.emit("unlock")},M.prototype.stop=function(){this.isLocked=!0,this.emit("lock")},M.prototype.await=function(e){const t=this;t.isLocked?t.once("unlock",e):setTimeout(e)};var I=function(e){var t=R(e);if(t>=e.params.length)return null;return e.params[t]};function R(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":return 1;case"eth_getBlockByNumber":return 0;default:return}}const C=function(){var e=(new Date).getTime()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t},N=r;var L=function(e){return N({id:C(),jsonrpc:"2.0",params:[]},e)};const D=e.exports.EventEmitter,O=t.inherits,H=n,F=g,K=o.exports,W=i.exports,j=U,z=L,V=function(){};var q=G;function G(e){const t=this;D.call(t),t.setMaxListeners(30),e=e||{};const r={sendAsync:t._handleAsync.bind(t)},n=e.blockTrackerProvider||r;t._blockTracker=e.blockTracker||new F({provider:n,pollingInterval:e.pollingInterval||4e3,setSkipCacheFlag:!0}),t._ready=new j,t.currentBlock=null,t._providers=[]}O(G,D),Object.defineProperty(G,"name",{value:"HttpProvider"}),G.prototype.start=function(e=V){const t=this;t._ready.go(),t._blockTracker.on("latest",(e=>{t._getBlockByNumber(e,((e,r)=>{if(e)return void this.emit("error",e);if(!r)return;const n=(o=r,{number:H.toBuffer(o.number),hash:H.toBuffer(o.hash),parentHash:H.toBuffer(o.parentHash),nonce:H.toBuffer(o.nonce),mixHash:H.toBuffer(o.mixHash),sha3Uncles:H.toBuffer(o.sha3Uncles),logsBloom:H.toBuffer(o.logsBloom),transactionsRoot:H.toBuffer(o.transactionsRoot),stateRoot:H.toBuffer(o.stateRoot),receiptsRoot:H.toBuffer(o.receiptRoot||o.receiptsRoot),miner:H.toBuffer(o.miner),difficulty:H.toBuffer(o.difficulty),totalDifficulty:H.toBuffer(o.totalDifficulty),size:H.toBuffer(o.size),extraData:H.toBuffer(o.extraData),gasLimit:H.toBuffer(o.gasLimit),gasUsed:H.toBuffer(o.gasUsed),timestamp:H.toBuffer(o.timestamp),transactions:o.transactions});var o;t._setCurrentBlock(n),t.emit("rawBlock",r),t.emit("latest",r)}))})),t._blockTracker.on("sync",t.emit.bind(t,"sync")),t._blockTracker.on("error",t.emit.bind(t,"error")),t._running=!0,t.emit("start")},G.prototype.stop=function(){const e=this;e._blockTracker.removeAllListeners(),e._running=!1,e.emit("stop")},G.prototype.isRunning=function(){return this._running},G.prototype.addProvider=function(e,t){const r=this;"number"==typeof t?r._providers.splice(t,0,e):r._providers.push(e),e.setEngine(this)},G.prototype.removeProvider=function(e){const t=this._providers.indexOf(e);if(t<0)throw new Error("Provider not found.");this._providers.splice(t,1)},G.prototype.send=function(e){throw new Error("Web3ProviderEngine does not support synchronous requests.")},G.prototype.sendAsync=function(e,t){const r=this;r._ready.await((function(){Array.isArray(e)?K(e,r._handleAsync.bind(r),t):r._handleAsync(e,t)}))},G.prototype._getBlockByNumber=function(e,t){const r=z({method:"eth_getBlockByNumber",params:[e,!1],skipCache:!0});this._handleAsync(r,((e,r)=>e?t(e):t(null,r.result)))},G.prototype._handleAsync=function(e,t){var r=this,n=-1,o=null,i=null,a=[];function s(r,n){i=r,o=n,W(a,(function(e,t){e?e(i,o,t):t()}),(function(){var r={id:e.id,jsonrpc:e.jsonrpc,result:o};null!=i?(r.error={message:i.stack||i.message||i,code:-32e3},t(i,r)):t(null,r)}))}!function t(o){if(n+=1,a.unshift(o),n>=r._providers.length)s(new Error('Request for method "'+e.method+'" not handled by any subprovider. Please check your subprovider configuration to ensure this method is handled.'));else try{r._providers[n].handleRequest(e,t,s)}catch(i){s(i)}}()},G.prototype._setCurrentBlock=function(e){this.currentBlock=e,this.emit("block",e)};const Y=L;var J=Z;function Z(){}Z.prototype.setEngine=function(e){const t=this;t.engine||(t.engine=e,e.on("block",(function(e){t.currentBlock=e})),e.on("start",(function(){t.start()})),e.on("stop",(function(){t.stop()})))},Z.prototype.handleRequest=function(e,t,r){throw new Error("Subproviders should override `handleRequest`.")},Z.prototype.emitPayload=function(e,t){this.engine.sendAsync(Y(e),t)},Z.prototype.stop=function(){},Z.prototype.start=function(){};const $=J;var X=class extends ${constructor(e){if(super(),!e)throw new Error("JsonRpcEngineMiddlewareSubprovider - no constructorFn specified");this._constructorFn=e}setEngine(e){if(this.middleware)throw new Error("JsonRpcEngineMiddlewareSubprovider - subprovider added to engine twice");const t=e._blockTracker,r=this._constructorFn({engine:e,provider:e,blockTracker:t});if(!r)throw new Error("JsonRpcEngineMiddlewareSubprovider - _constructorFn did not return middleware");if("function"!=typeof r)throw new Error("JsonRpcEngineMiddlewareSubprovider - specified middleware is not a function");this.middleware=r}handleRequest(e,t,r){const n={id:e.id};this.middleware(e,n,(function(e){t(((t,r,o)=>{t?(delete n.result,n.error={message:t.message||t}):n.result=r,e?e(o):o()}))}),(function(e){if(e)return r(e);r(null,n.result)}))}};const Q=m;function ee(e){return"never"!==ne(e)}function te(e){const t=re(e);return t>=e.params.length?e.params:"eth_getBlockByNumber"===e.method?e.params.slice(1):e.params.slice(0,t)}function re(e){switch(e.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return}}function ne(e){switch(e.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";case"net_version":case"net_peerCount":case"net_listening":case"eth_syncing":case"eth_sign":case"eth_coinbase":case"eth_mining":case"eth_hashrate":case"eth_accounts":case"eth_sendTransaction":case"eth_sendRawTransaction":case"eth_newFilter":case"eth_newBlockFilter":case"eth_newPendingTransactionFilter":case"eth_uninstallFilter":case"eth_getFilterChanges":case"eth_getWork":case"eth_submitWork":case"eth_submitHashrate":case"db_putString":case"db_getString":case"db_putHex":case"db_getHex":case"shh_post":case"shh_newIdentity":case"shh_hasIdentity":case"shh_newGroup":case"shh_addToGroup":case"shh_newFilter":case"shh_uninstallFilter":case"shh_getFilterChanges":case"shh_getMessages":case"test_neverCache":return"never"}}const oe={cacheIdentifierForPayload:function(e,t){const r=t?te(e):e.params;return ee(e)?e.method+":"+Q(r):null},canCache:ee,blockTagForPayload:function(e){let t=re(e);if(t>=e.params.length)return null;return e.params[t]},paramsWithoutBlockTag:te,blockTagParamIndex:re,cacheTypeForPayload:ne},ie=function(e){return(t,r,n,o)=>{let i;const a=new Promise((e=>{i=e}));let s,c;e(t,r,(async()=>{c=!0,n((e=>{s=e,i()})),await a})).then((async()=>{c?(await a,s(null)):o(null)})).catch((e=>{s?s(e):o(e)}))}},ae=[void 0,null,"<nil>"];var se=function(e={}){const{blockTracker:t}=e;if(!t)throw new Error("createBlockCacheMiddleware - No BlockTracker specified");const r=new ce,n={perma:r,block:r,fork:r};return ie((async(e,o,i)=>{if(e.skipCache)return i();const a=oe.cacheTypeForPayload(e),s=n[a];if(!s)return i();if(!s.canCacheRequest(e))return i();let c,u=oe.blockTagForPayload(e);if(u||(u="latest"),"earliest"===u)c="0x00";else if("latest"===u){const e=await t.getLatestBlock();r.clearBefore(e),c=e}else c=u;const f=await s.get(e,c);void 0===f?(await i(),await s.set(e,c,o.result)):o.result=f}))};class ce{constructor(){this.cache={}}getBlockCacheForPayload(e,t){const r=Number.parseInt(t,16);let n=this.cache[r];if(!n){const e={};this.cache[r]=e,n=e}return n}async get(e,t){const r=this.getBlockCacheForPayload(e,t);if(!r)return;return r[oe.cacheIdentifierForPayload(e,!0)]}async set(e,t,r){if(!this.canCacheResult(e,r))return;this.getBlockCacheForPayload(e,t)[oe.cacheIdentifierForPayload(e,!0)]=r}canCacheRequest(e){if(!oe.canCache(e))return!1;return"pending"!==oe.blockTagForPayload(e)}canCacheResult(e,t){if(!ae.includes(t))return!!(!["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(e.method)||t&&t.blockHash&&"0x0000000000000000000000000000000000000000000000000000000000000000"!==t.blockHash)}clearBefore(e){const t=this,r=Number.parseInt(e,16);Object.keys(t.cache).map(Number).filter((e=>e<r)).forEach((e=>delete t.cache[e]))}}const ue=X,fe=se;var le=class extends ue{constructor(e){super((({blockTracker:t})=>fe(Object.assign({blockTracker:t},e))))}};const he=t.inherits;var de=pe;function pe(e){e=e||{},this.staticResponses=e}he(pe,J),pe.prototype.handleRequest=function(e,t,r){var n=this.staticResponses[e.method];"function"==typeof n?n(e,t,r):void 0!==n?setTimeout((()=>r(null,n))):t()};const ge=X,ye=y;var ve=class extends ge{constructor(){super((({blockTracker:e,provider:t,engine:r})=>ye({blockTracker:e,provider:t})))}},me={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t=(0,o.default)(t||n.default),!(0,r.default)(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var a=0;function s(t){var r=(0,d.default)(e[a++]);t.push((0,h.default)(c)),r.apply(null,t)}function c(r){if(r||a===e.length)return t.apply(null,arguments);s((0,i.default)(arguments,1))}s([])};var r=p(l),n=p(a),o=p(s.exports),i=p(c.exports),h=p(u.exports),d=p(f);function p(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}(me,me.exports);var we={exports:{}},be={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){a=a||r.default;var s=(0,n.default)(t)?[]:{};e(t,(function(e,t,r){(0,i.default)(e)((function(e,n){arguments.length>2&&(n=(0,o.default)(arguments,1)),s[t]=n,r(e)}))}),(function(e){a(e,s)}))};var r=s(a),n=s(h),o=s(c.exports),i=s(f);function s(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}(be,be.exports),function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,n.default)(r.default,e,t)};var r=o(d.exports),n=o(be.exports);function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default}(we,we.exports);var _e={},xe={},Ee={},ke=k.exports,Te=new(0,w.ec)("secp256k1"),Ae=Te.curve;Ee.privateKeyExport=function(e,t){var r=new ke(e);if(r.ucmp(Ae.n)>=0)throw new Error("couldn't export to DER format");var n=Te.g.mul(r);return Be(n.getX(),n.getY(),t)},Ee.privateKeyModInverse=function(e){var t=new ke(e);if(t.ucmp(Ae.n)>=0||t.isZero())throw new Error("private key range is invalid");return t.invm(Ae.n).toArrayLike(Buffer,"be",32)},Ee.signatureImport=function(e){var t=new ke(e.r);t.ucmp(Ae.n)>=0&&(t=new ke(0));var r=new ke(e.s);return r.ucmp(Ae.n)>=0&&(r=new ke(0)),Buffer.concat([t.toArrayLike(Buffer,"be",32),r.toArrayLike(Buffer,"be",32)])},Ee.ecdhUnsafe=function(e,t,r){var n=Te.keyFromPublic(e),o=new ke(t);if(o.ucmp(Ae.n)>=0||o.isZero())throw new Error("scalar was invalid (zero or overflow)");var i=n.pub.mul(o);return Be(i.getX(),i.getY(),r)};var Be=function(e,t,r){var n=void 0;return r?((n=Buffer.alloc(33))[0]=t.isOdd()?3:2,e.toArrayLike(Buffer,"be",32).copy(n,1)):((n=Buffer.alloc(65))[0]=4,e.toArrayLike(Buffer,"be",32).copy(n,1),t.toArrayLike(Buffer,"be",32).copy(n,33)),n},Pe={},Se=Buffer.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ue=Buffer.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);Pe.privateKeyExport=function(e,t,r){var n=Buffer.from(r?Se:Ue);return e.copy(n,r?8:9),t.copy(n,r?181:214),n},Pe.privateKeyImport=function(e){var t=e.length,r=0;if(t<r+1||48!==e[r])return null;if(t<(r+=1)+1||!(128&e[r]))return null;var n=127&e[r];if(n<1||n>2)return null;if(t<(r+=1)+n)return null;var o=e[r+n-1]|(n>1?e[r+n-2]<<8:0);return t<(r+=n)+o||t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2]||t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]?null:e.slice(r+2,r+2+e[r+1])},Pe.signatureImportLax=function(e){var t=Buffer.alloc(32,0),r=Buffer.alloc(32,0),n=e.length,o=0;if(48!==e[o++])return null;var i=e[o++];if(128&i&&(o+=i-128)>n)return null;if(2!==e[o++])return null;var a=e[o++];if(128&a){if(o+(i=a-128)>n)return null;for(;i>0&&0===e[o];o+=1,i-=1);for(a=0;i>0;o+=1,i-=1)a=(a<<8)+e[o]}if(a>n-o)return null;var s=o;if(o+=a,2!==e[o++])return null;var c=e[o++];if(128&c){if(o+(i=c-128)>n)return null;for(;i>0&&0===e[o];o+=1,i-=1);for(c=0;i>0;o+=1,i-=1)c=(c<<8)+e[o]}if(c>n-o)return null;var u=o;for(o+=c;a>0&&0===e[s];a-=1,s+=1);if(a>32)return null;var f=e.slice(s,s+a);for(f.copy(t,32-f.length);c>0&&0===e[u];c-=1,u+=1);if(c>32)return null;var l=e.slice(u,u+c);return l.copy(r,32-l.length),{r:t,s:r}};var Me=b,Ie=Ee,Re=Pe,Ce=function(e){return 32===e.length&&Me.privateKeyVerify(Uint8Array.from(e))},Ne={privateKeyVerify:Ce,privateKeyExport:function(e,t){if(32!==e.length)throw new RangeError("private key length is invalid");var r=Ie.privateKeyExport(e,t);return Re.privateKeyExport(e,r,t)},privateKeyImport:function(e){if(null!==(e=Re.privateKeyImport(e))&&32===e.length&&Ce(e))return e;throw new Error("couldn't import from DER format")},privateKeyNegate:function(e){return Buffer.from(Me.privateKeyNegate(Uint8Array.from(e)))},privateKeyModInverse:function(e){if(32!==e.length)throw new Error("private key length is invalid");return Buffer.from(Ie.privateKeyModInverse(Uint8Array.from(e)))},privateKeyTweakAdd:function(e,t){return Buffer.from(Me.privateKeyTweakAdd(Uint8Array.from(e),t))},privateKeyTweakMul:function(e,t){return Buffer.from(Me.privateKeyTweakMul(Uint8Array.from(e),Uint8Array.from(t)))},publicKeyCreate:function(e,t){return Buffer.from(Me.publicKeyCreate(Uint8Array.from(e),t))},publicKeyConvert:function(e,t){return Buffer.from(Me.publicKeyConvert(Uint8Array.from(e),t))},publicKeyVerify:function(e){return(33===e.length||65===e.length)&&Me.publicKeyVerify(Uint8Array.from(e))},publicKeyTweakAdd:function(e,t,r){return Buffer.from(Me.publicKeyTweakAdd(Uint8Array.from(e),Uint8Array.from(t),r))},publicKeyTweakMul:function(e,t,r){return Buffer.from(Me.publicKeyTweakMul(Uint8Array.from(e),Uint8Array.from(t),r))},publicKeyCombine:function(e,t){var r=[];return e.forEach((function(e){r.push(Uint8Array.from(e))})),Buffer.from(Me.publicKeyCombine(r,t))},signatureNormalize:function(e){return Buffer.from(Me.signatureNormalize(Uint8Array.from(e)))},signatureExport:function(e){return Buffer.from(Me.signatureExport(Uint8Array.from(e)))},signatureImport:function(e){return Buffer.from(Me.signatureImport(Uint8Array.from(e)))},signatureImportLax:function(e){if(0===e.length)throw new RangeError("signature length is invalid");var t=Re.signatureImportLax(e);if(null===t)throw new Error("couldn't parse DER signature");return Ie.signatureImport(t)},sign:function(e,t,r){if(null===r)throw new TypeError("options should be an Object");var n=void 0;if(r){if(n={},null===r.data)throw new TypeError("options.data should be a Buffer");if(r.data){if(32!==r.data.length)throw new RangeError("options.data length is invalid");n.data=new Uint8Array(r.data)}if(null===r.noncefn)throw new TypeError("options.noncefn should be a Function");r.noncefn&&(n.noncefn=function(e,t,n,o,i){var a=null!=n?Buffer.from(n):null,s=null!=o?Buffer.from(o):null,c=Buffer.from("");return r.noncefn&&(c=r.noncefn(Buffer.from(e),Buffer.from(t),a,s,i)),Uint8Array.from(c)})}var o=Me.ecdsaSign(Uint8Array.from(e),Uint8Array.from(t),n);return{signature:Buffer.from(o.signature),recovery:o.recid}},verify:function(e,t,r){return Me.ecdsaVerify(Uint8Array.from(t),Uint8Array.from(e),r)},recover:function(e,t,r,n){return Buffer.from(Me.ecdsaRecover(Uint8Array.from(t),r,Uint8Array.from(e),n))},ecdh:function(e,t){return Buffer.from(Me.ecdh(Uint8Array.from(e),Uint8Array.from(t),{}))},ecdhUnsafe:function(e,t,r){if(33!==e.length&&65!==e.length)throw new RangeError("public key length is invalid");if(32!==t.length)throw new RangeError("private key length is invalid");return Buffer.from(Ie.ecdhUnsafe(Uint8Array.from(e),Uint8Array.from(t),r))}};!function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=_,n=r.keccak224,o=r.keccak384,i=r.keccak256,a=r.keccak512,s=Ne,c=T,u=x,f=k.exports,l=E;e.MAX_INTEGER=new f("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),e.TWO_POW256=new f("10000000000000000000000000000000000000000000000000000000000000000",16),e.SHA3_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",e.SHA3_NULL=new Buffer(e.SHA3_NULL_S,"hex"),e.SHA3_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",e.SHA3_RLP_ARRAY=new Buffer(e.SHA3_RLP_ARRAY_S,"hex"),e.SHA3_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",e.SHA3_RLP=new Buffer(e.SHA3_RLP_S,"hex"),e.BN=f,e.rlp=u,e.secp256k1=s,e.zeros=function(e){var t=new Buffer(e);return t.fill(0),t},e.setLengthLeft=e.setLength=function(t,r,n){var o=e.zeros(r);return t=e.toBuffer(t),n?t.length<r?(t.copy(o),o):t.slice(0,r):t.length<r?(t.copy(o,r-t.length),o):t.slice(-r)},e.setLengthRight=function(t,r){return e.setLength(t,r,!0)},e.unpad=e.stripZeros=function(t){for(var r=(t=e.stripHexPrefix(t))[0];t.length>0&&"0"===r.toString();)r=(t=t.slice(1))[0];return t},e.toBuffer=function(t){if(!Buffer.isBuffer(t))if(Array.isArray(t))t=new Buffer(t);else if("string"==typeof t)t=e.isHexPrefixed(t)?new Buffer(e.padToEven(e.stripHexPrefix(t)),"hex"):new Buffer(t);else if("number"==typeof t)t=e.intToBuffer(t);else if(null==t)t=new Buffer([]);else{if(!t.toArray)throw new Error("invalid type");t=new Buffer(t.toArray())}return t},e.intToHex=function(e){c(e%1==0,"number is not a integer"),c(e>=0,"number must be positive");var t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t},e.intToBuffer=function(t){var r=e.intToHex(t);return new Buffer(r.slice(2),"hex")},e.bufferToInt=function(t){return parseInt(e.bufferToHex(t),16)},e.bufferToHex=function(t){return 0===(t=e.toBuffer(t)).length?0:"0x"+t.toString("hex")},e.fromSigned=function(e){return new f(e).fromTwos(256)},e.toUnsigned=function(e){return new Buffer(e.toTwos(256).toArray())},e.sha3=function(t,r){switch(t=e.toBuffer(t),r||(r=256),r){case 224:return n(t);case 256:return i(t);case 384:return o(t);case 512:return a(t);default:throw new Error("Invalid algorithm: keccak"+r)}},e.sha256=function(t){return t=e.toBuffer(t),l("sha256").update(t).digest()},e.ripemd160=function(t,r){t=e.toBuffer(t);var n=l("rmd160").update(t).digest();return!0===r?e.setLength(n,32):n},e.rlphash=function(t){return e.sha3(u.encode(t))},e.isValidPrivate=function(e){return s.privateKeyVerify(e)},e.isValidPublic=function(e,t){return 64===e.length?s.publicKeyVerify(Buffer.concat([new Buffer([4]),e])):!!t&&s.publicKeyVerify(e)},e.pubToAddress=e.publicToAddress=function(t,r){return t=e.toBuffer(t),r&&64!==t.length&&(t=s.publicKeyConvert(t,!1).slice(1)),c(64===t.length),e.sha3(t).slice(-20)};var h=e.privateToPublic=function(t){return t=e.toBuffer(t),s.publicKeyCreate(t,!1).slice(1)};e.importPublic=function(t){return 64!==(t=e.toBuffer(t)).length&&(t=s.publicKeyConvert(t,!1).slice(1)),t},e.ecsign=function(e,t){var r=s.sign(e,t),n={};return n.r=r.signature.slice(0,32),n.s=r.signature.slice(32,64),n.v=r.recovery+27,n},e.ecrecover=function(t,r,n,o){var i=Buffer.concat([e.setLength(n,32),e.setLength(o,32)],64),a=e.bufferToInt(r)-27;if(0!==a&&1!==a)throw new Error("Invalid signature v value");var c=s.recover(t,i,a);return s.publicKeyConvert(c,!1).slice(1)},e.toRpcSig=function(t,r,n){return e.bufferToHex(Buffer.concat([r,n,e.toBuffer(t-27)]))},e.fromRpcSig=function(t){var r=(t=e.toBuffer(t))[64];return r<27&&(r+=27),{v:r,r:t.slice(0,32),s:t.slice(32,64)}},e.privateToAddress=function(t){return e.publicToAddress(h(t))},e.isValidAddress=function(e){return/^0x[0-9a-fA-F]{40}$/i.test(e)},e.toChecksumAddress=function(t){t=e.stripHexPrefix(t).toLowerCase();for(var r=e.sha3(t).toString("hex"),n="0x",o=0;o<t.length;o++)parseInt(r[o],16)>=8?n+=t[o].toUpperCase():n+=t[o];return n},e.isValidChecksumAddress=function(t){return e.isValidAddress(t)&&e.toChecksumAddress(t)===t},e.generateAddress=function(t,r){return t=e.toBuffer(t),r=(r=new f(r)).isZero()?null:new Buffer(r.toArray()),e.rlphash([t,r]).slice(-20)},e.isPrecompiled=function(t){var r=e.unpad(t);return 1===r.length&&r[0]>0&&r[0]<5},e.isHexPrefixed=function(e){return"0x"===e.slice(0,2)},e.stripHexPrefix=function(t){return"string"!=typeof t?t:e.isHexPrefixed(t)?t.slice(2):t},e.addHexPrefix=function(t){return"string"!=typeof t||e.isHexPrefixed(t)?t:"0x"+t},e.padToEven=function(e){return e.length%2&&(e="0"+e),e},e.baToJSON=function(t){if(Buffer.isBuffer(t))return"0x"+t.toString("hex");if(t instanceof Array){for(var r=[],n=0;n<t.length;n++)r.push(e.baToJSON(t[n]));return r}},e.defineProperties=function(r,n,o){if(r.raw=[],r._fields=[],r.toJSON=function(t){if(t){var n={};return r._fields.forEach((function(e){n[e]="0x"+r[e].toString("hex")})),n}return e.baToJSON(this.raw)},r.serialize=function(){return u.encode(r.raw)},n.forEach((function(t,n){function o(){return r.raw[n]}function i(o){"00"!==(o=e.toBuffer(o)).toString("hex")||t.allowZero||(o=new Buffer([])),t.allowLess&&t.length?(o=e.stripZeros(o),c(t.length>=o.length,"The field "+t.name+" must not have more "+t.length+" bytes")):t.allowZero&&0===o.length||!t.length||c(t.length===o.length,"The field "+t.name+" must have byte length of "+t.length),r.raw[n]=o}r._fields.push(t.name),Object.defineProperty(r,t.name,{enumerable:!0,configurable:!0,get:o,set:i}),t.default&&(r[t.name]=t.default),t.alias&&Object.defineProperty(r,t.alias,{enumerable:!1,configurable:!0,set:i,get:o})})),o)if("string"==typeof o&&(o=new Buffer(e.stripHexPrefix(o),"hex")),Buffer.isBuffer(o)&&(o=u.decode(o)),Array.isArray(o)){if(o.length>r._fields.length)throw new Error("wrong number of fields in data");o.forEach((function(t,n){r[r._fields[n]]=e.toBuffer(t)}))}else{if("object"!==(void 0===o?"undefined":t(o)))throw new Error("invalid data");for(var i in o)-1!==r._fields.indexOf(i)&&(r[i]=o[i])}}}(xe);const Le=xe,De=k.exports;var Oe=function(){};function He(e){return e.startsWith("int[")?"int256"+e.slice(3):"int"===e?"int256":e.startsWith("uint[")?"uint256"+e.slice(4):"uint"===e?"uint256":e.startsWith("fixed[")?"fixed128x128"+e.slice(5):"fixed"===e?"fixed128x128":e.startsWith("ufixed[")?"ufixed128x128"+e.slice(6):"ufixed"===e?"ufixed128x128":e}function Fe(e){return parseInt(/^\D+(\d+)$/.exec(e)[1],10)}function Ke(e){var t=/^\D+(\d+)x(\d+)$/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]}function We(e){var t=e.match(/(.*)\[(.*?)\]$/);return t?""===t[2]?"dynamic":parseInt(t[2],10):null}function je(e){var t=typeof e;if("string"===t)return Le.isHexPrefixed(e)?new De(Le.stripHexPrefix(e),16):new De(e,10);if("number"===t)return new De(e);if(e.toArray)return e;throw new Error("Argument is not a number")}function ze(e){var t=/^(\w+)\((.+)\)$/.exec(e);if(3!==t.length)throw new Error("Invalid method signature");var r=/^(.+)\):\((.+)$/.exec(t[2]);return null!==r&&3===r.length?{method:t[1],args:r[1].split(","),retargs:r[2].split(",")}:{method:t[1],args:t[2].split(",")}}function Ve(e,t){var r,n,o,i;if("address"===e)return Ve("uint160",je(t));if("bool"===e)return Ve("uint8",t?1:0);if("string"===e)return Ve("bytes",new Buffer(t,"utf8"));if(Je(e)){if(void 0===t.length)throw new Error("Not an array?");if("dynamic"!==(r=We(e))&&0!==r&&t.length>r)throw new Error("Elements exceed array size: "+r);for(i in o=[],e=e.slice(0,e.lastIndexOf("[")),"string"==typeof t&&(t=JSON.parse(t)),t)o.push(Ve(e,t[i]));if("dynamic"===r){var a=Ve("uint256",t.length);o.unshift(a)}return Buffer.concat(o)}if("bytes"===e)return t=new Buffer(t),o=Buffer.concat([Ve("uint256",t.length),t]),t.length%32!=0&&(o=Buffer.concat([o,Le.zeros(32-t.length%32)])),o;if(e.startsWith("bytes")){if((r=Fe(e))<1||r>32)throw new Error("Invalid bytes<N> width: "+r);return Le.setLengthRight(t,32)}if(e.startsWith("uint")){if((r=Fe(e))%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if((n=je(t)).bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+n.bitLength());if(n<0)throw new Error("Supplied uint is negative");return n.toArrayLike(Buffer,"be",32)}if(e.startsWith("int")){if((r=Fe(e))%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if((n=je(t)).bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+n.bitLength());return n.toTwos(256).toArrayLike(Buffer,"be",32)}if(e.startsWith("ufixed")){if(r=Ke(e),(n=je(t))<0)throw new Error("Supplied ufixed is negative");return Ve("uint256",n.mul(new De(2).pow(new De(r[1]))))}if(e.startsWith("fixed"))return r=Ke(e),Ve("int256",je(t).mul(new De(2).pow(new De(r[1]))));throw new Error("Unsupported or invalid type: "+e)}function qe(e,t,r){var n,o,i,a;if("string"==typeof e&&(e=Ge(e)),"address"===e.name)return qe(e.rawType,t,r).toArrayLike(Buffer,"be",20).toString("hex");if("bool"===e.name)return qe(e.rawType,t,r).toString()===new De(1).toString();if("string"===e.name){var s=qe(e.rawType,t,r);return new Buffer(s,"utf8").toString()}if(e.isArray){for(i=[],n=e.size,"dynamic"===e.size&&(r=qe("uint256",t,r).toNumber(),n=qe("uint256",t,r).toNumber(),r+=32),a=0;a<n;a++){var c=qe(e.subArray,t,r);i.push(c),r+=e.subArray.memoryUsage}return i}if("bytes"===e.name)return r=qe("uint256",t,r).toNumber(),n=qe("uint256",t,r).toNumber(),t.slice(r+32,r+32+n);if(e.name.startsWith("bytes"))return t.slice(r,r+e.size);if(e.name.startsWith("uint")){if((o=new De(t.slice(r,r+32),16,"be")).bitLength()>e.size)throw new Error("Decoded int exceeds width: "+e.size+" vs "+o.bitLength());return o}if(e.name.startsWith("int")){if((o=new De(t.slice(r,r+32),16,"be").fromTwos(256)).bitLength()>e.size)throw new Error("Decoded uint exceeds width: "+e.size+" vs "+o.bitLength());return o}if(e.name.startsWith("ufixed")){if(n=new De(2).pow(new De(e.size[1])),!(o=qe("uint256",t,r)).mod(n).isZero())throw new Error("Decimals not supported yet");return o.div(n)}if(e.name.startsWith("fixed")){if(n=new De(2).pow(new De(e.size[1])),!(o=qe("int256",t,r)).mod(n).isZero())throw new Error("Decimals not supported yet");return o.div(n)}throw new Error("Unsupported or invalid type: "+e.name)}function Ge(e){var t,r,n;if(Je(e)){t=We(e);var o=e.slice(0,e.lastIndexOf("["));return o=Ge(o),r={isArray:!0,name:e,size:t,memoryUsage:"dynamic"===t?32:o.memoryUsage*t,subArray:o}}switch(e){case"address":n="uint160";break;case"bool":n="uint8";break;case"string":n="bytes"}if(r={rawType:n,name:e,memoryUsage:32},e.startsWith("bytes")&&"bytes"!==e||e.startsWith("uint")||e.startsWith("int")?r.size=Fe(e):(e.startsWith("ufixed")||e.startsWith("fixed"))&&(r.size=Ke(e)),e.startsWith("bytes")&&"bytes"!==e&&(r.size<1||r.size>32))throw new Error("Invalid bytes<N> width: "+r.size);if((e.startsWith("uint")||e.startsWith("int"))&&(r.size%8||r.size<8||r.size>256))throw new Error("Invalid int/uint<N> width: "+r.size);return r}function Ye(e){return"string"===e||"bytes"===e||"dynamic"===We(e)}function Je(e){return e.lastIndexOf("]")===e.length-1}function Ze(e,t){return e.startsWith("address")||e.startsWith("bytes")?"0x"+t.toString("hex"):t.toString()}Oe.eventID=function(e,t){var r=e+"("+t.map(He).join(",")+")";return Le.sha3(new Buffer(r))},Oe.methodID=function(e,t){return Oe.eventID(e,t).slice(0,4)},Oe.rawEncode=function(e,t){var r=[],n=[],o=32*e.length;for(var i in e){var a=He(e[i]),s=Ve(a,t[i]);Ye(a)?(r.push(Ve("uint256",o)),n.push(s),o+=s.length):r.push(s)}return Buffer.concat(r.concat(n))},Oe.rawDecode=function(e,t){var r=[];t=new Buffer(t);var n=0;for(var o in e){var i=Ge(He(e[o])),a=qe(i,t,n);n+=i.memoryUsage,r.push(a)}return r},Oe.simpleEncode=function(e){var t=Array.prototype.slice.call(arguments).slice(1),r=ze(e);if(t.length!==r.args.length)throw new Error("Argument count mismatch");return Buffer.concat([Oe.methodID(r.method,r.args),Oe.rawEncode(r.args,t)])},Oe.simpleDecode=function(e,t){var r=ze(e);if(!r.retargs)throw new Error("No return values in method");return Oe.rawDecode(r.retargs,t)},Oe.stringify=function(e,t){var r=[];for(var n in e){var o=e[n],i=t[n];i=/^[^\[]+\[.*\]$/.test(o)?i.map((function(e){return Ze(o,e)})).join(", "):Ze(o,i),r.push(i)}return r},Oe.solidityPack=function(e,t){if(e.length!==t.length)throw new Error("Number of types are not matching the values");for(var r,n,o=[],i=0;i<e.length;i++){var a=He(e[i]),s=t[i];if("bytes"===a)o.push(s);else if("string"===a)o.push(new Buffer(s,"utf8"));else if("bool"===a)o.push(new Buffer(s?"01":"00","hex"));else if("address"===a)o.push(Le.setLengthLeft(s,20));else if(a.startsWith("bytes")){if((r=Fe(a))<1||r>32)throw new Error("Invalid bytes<N> width: "+r);o.push(Le.setLengthRight(s,r))}else if(a.startsWith("uint")){if((r=Fe(a))%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if((n=je(s)).bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+n.bitLength());o.push(n.toArrayLike(Buffer,"be",r/8))}else{if(!a.startsWith("int"))throw new Error("Unsupported or invalid type: "+a);if((r=Fe(a))%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if((n=je(s)).bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+n.bitLength());o.push(n.toTwos(r).toArrayLike(Buffer,"be",r/8))}}return Buffer.concat(o)},Oe.soliditySHA3=function(e,t){return Le.sha3(Oe.solidityPack(e,t))},Oe.soliditySHA256=function(e,t){return Le.sha256(Oe.solidityPack(e,t))},Oe.solidityRIPEMD160=function(e,t){return Le.ripemd160(Oe.solidityPack(e,t),!0)},Oe.fromSerpent=function(e){for(var t,r=[],n=0;n<e.length;n++){var o=e[n];if("s"===o)r.push("bytes");else if("b"===o){for(var i="bytes",a=n+1;a<e.length&&((t=e[a])>="0"&&t<="9");)i+=e[a]-"0",a++;n=a-1,r.push(i)}else if("i"===o)r.push("int256");else{if("a"!==o)throw new Error("Unsupported or invalid type: "+o);r.push("int256[]")}}return r},Oe.toSerpent=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if("bytes"===n)t.push("s");else if(n.startsWith("bytes"))t.push("b"+Fe(n));else if("int256"===n)t.push("i");else{if("int256[]"!==n)throw new Error("Unsupported or invalid type: "+n);t.push("a")}}return t.join("")};var $e=Oe,Xe={exports:{}};!function(e){var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},r=function(){throw new Error("no PRNG")},n=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var i=t(),a=t([1]),s=t([56129,1]),c=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),u=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),h=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function p(e,t,r,n,o){var i,a=0;for(i=0;i<o;i++)a|=e[t+i]^r[n+i];return(1&a-1>>>8)-1}function g(e,t,r,n){return p(e,t,r,n,16)}function y(e,t,r,n){return p(e,t,r,n,32)}function v(e,t,r,n){!function(e,t,r,n){for(var o,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,f=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,y=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,b=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=i,x=a,E=s,k=c,T=u,A=f,B=l,P=h,S=d,U=p,M=g,I=y,R=v,C=m,N=w,L=b,D=0;D<20;D+=2)_^=(o=(R^=(o=(S^=(o=(T^=(o=_+R|0)<<7|o>>>25)+_|0)<<9|o>>>23)+T|0)<<13|o>>>19)+S|0)<<18|o>>>14,A^=(o=(x^=(o=(C^=(o=(U^=(o=A+x|0)<<7|o>>>25)+A|0)<<9|o>>>23)+U|0)<<13|o>>>19)+C|0)<<18|o>>>14,M^=(o=(B^=(o=(E^=(o=(N^=(o=M+B|0)<<7|o>>>25)+M|0)<<9|o>>>23)+N|0)<<13|o>>>19)+E|0)<<18|o>>>14,L^=(o=(I^=(o=(P^=(o=(k^=(o=L+I|0)<<7|o>>>25)+L|0)<<9|o>>>23)+k|0)<<13|o>>>19)+P|0)<<18|o>>>14,_^=(o=(k^=(o=(E^=(o=(x^=(o=_+k|0)<<7|o>>>25)+_|0)<<9|o>>>23)+x|0)<<13|o>>>19)+E|0)<<18|o>>>14,A^=(o=(T^=(o=(P^=(o=(B^=(o=A+T|0)<<7|o>>>25)+A|0)<<9|o>>>23)+B|0)<<13|o>>>19)+P|0)<<18|o>>>14,M^=(o=(U^=(o=(S^=(o=(I^=(o=M+U|0)<<7|o>>>25)+M|0)<<9|o>>>23)+I|0)<<13|o>>>19)+S|0)<<18|o>>>14,L^=(o=(N^=(o=(C^=(o=(R^=(o=L+N|0)<<7|o>>>25)+L|0)<<9|o>>>23)+R|0)<<13|o>>>19)+C|0)<<18|o>>>14;_=_+i|0,x=x+a|0,E=E+s|0,k=k+c|0,T=T+u|0,A=A+f|0,B=B+l|0,P=P+h|0,S=S+d|0,U=U+p|0,M=M+g|0,I=I+y|0,R=R+v|0,C=C+m|0,N=N+w|0,L=L+b|0,e[0]=_>>>0&255,e[1]=_>>>8&255,e[2]=_>>>16&255,e[3]=_>>>24&255,e[4]=x>>>0&255,e[5]=x>>>8&255,e[6]=x>>>16&255,e[7]=x>>>24&255,e[8]=E>>>0&255,e[9]=E>>>8&255,e[10]=E>>>16&255,e[11]=E>>>24&255,e[12]=k>>>0&255,e[13]=k>>>8&255,e[14]=k>>>16&255,e[15]=k>>>24&255,e[16]=T>>>0&255,e[17]=T>>>8&255,e[18]=T>>>16&255,e[19]=T>>>24&255,e[20]=A>>>0&255,e[21]=A>>>8&255,e[22]=A>>>16&255,e[23]=A>>>24&255,e[24]=B>>>0&255,e[25]=B>>>8&255,e[26]=B>>>16&255,e[27]=B>>>24&255,e[28]=P>>>0&255,e[29]=P>>>8&255,e[30]=P>>>16&255,e[31]=P>>>24&255,e[32]=S>>>0&255,e[33]=S>>>8&255,e[34]=S>>>16&255,e[35]=S>>>24&255,e[36]=U>>>0&255,e[37]=U>>>8&255,e[38]=U>>>16&255,e[39]=U>>>24&255,e[40]=M>>>0&255,e[41]=M>>>8&255,e[42]=M>>>16&255,e[43]=M>>>24&255,e[44]=I>>>0&255,e[45]=I>>>8&255,e[46]=I>>>16&255,e[47]=I>>>24&255,e[48]=R>>>0&255,e[49]=R>>>8&255,e[50]=R>>>16&255,e[51]=R>>>24&255,e[52]=C>>>0&255,e[53]=C>>>8&255,e[54]=C>>>16&255,e[55]=C>>>24&255,e[56]=N>>>0&255,e[57]=N>>>8&255,e[58]=N>>>16&255,e[59]=N>>>24&255,e[60]=L>>>0&255,e[61]=L>>>8&255,e[62]=L>>>16&255,e[63]=L>>>24&255}(e,t,r,n)}function m(e,t,r,n){!function(e,t,r,n){for(var o,i=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,f=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,l=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,h=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,y=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,w=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,b=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,_=0;_<20;_+=2)i^=(o=(v^=(o=(d^=(o=(u^=(o=i+v|0)<<7|o>>>25)+i|0)<<9|o>>>23)+u|0)<<13|o>>>19)+d|0)<<18|o>>>14,f^=(o=(a^=(o=(m^=(o=(p^=(o=f+a|0)<<7|o>>>25)+f|0)<<9|o>>>23)+p|0)<<13|o>>>19)+m|0)<<18|o>>>14,g^=(o=(l^=(o=(s^=(o=(w^=(o=g+l|0)<<7|o>>>25)+g|0)<<9|o>>>23)+w|0)<<13|o>>>19)+s|0)<<18|o>>>14,b^=(o=(y^=(o=(h^=(o=(c^=(o=b+y|0)<<7|o>>>25)+b|0)<<9|o>>>23)+c|0)<<13|o>>>19)+h|0)<<18|o>>>14,i^=(o=(c^=(o=(s^=(o=(a^=(o=i+c|0)<<7|o>>>25)+i|0)<<9|o>>>23)+a|0)<<13|o>>>19)+s|0)<<18|o>>>14,f^=(o=(u^=(o=(h^=(o=(l^=(o=f+u|0)<<7|o>>>25)+f|0)<<9|o>>>23)+l|0)<<13|o>>>19)+h|0)<<18|o>>>14,g^=(o=(p^=(o=(d^=(o=(y^=(o=g+p|0)<<7|o>>>25)+g|0)<<9|o>>>23)+y|0)<<13|o>>>19)+d|0)<<18|o>>>14,b^=(o=(w^=(o=(m^=(o=(v^=(o=b+w|0)<<7|o>>>25)+b|0)<<9|o>>>23)+v|0)<<13|o>>>19)+m|0)<<18|o>>>14;e[0]=i>>>0&255,e[1]=i>>>8&255,e[2]=i>>>16&255,e[3]=i>>>24&255,e[4]=f>>>0&255,e[5]=f>>>8&255,e[6]=f>>>16&255,e[7]=f>>>24&255,e[8]=g>>>0&255,e[9]=g>>>8&255,e[10]=g>>>16&255,e[11]=g>>>24&255,e[12]=b>>>0&255,e[13]=b>>>8&255,e[14]=b>>>16&255,e[15]=b>>>24&255,e[16]=l>>>0&255,e[17]=l>>>8&255,e[18]=l>>>16&255,e[19]=l>>>24&255,e[20]=h>>>0&255,e[21]=h>>>8&255,e[22]=h>>>16&255,e[23]=h>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var w=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function b(e,t,r,n,o,i,a){var s,c,u=new Uint8Array(16),f=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=i[c];for(;o>=64;){for(v(f,u,a,w),c=0;c<64;c++)e[t+c]=r[n+c]^f[c];for(s=1,c=8;c<16;c++)s=s+(255&u[c])|0,u[c]=255&s,s>>>=8;o-=64,t+=64,n+=64}if(o>0)for(v(f,u,a,w),c=0;c<o;c++)e[t+c]=r[n+c]^f[c];return 0}function _(e,t,r,n,o){var i,a,s=new Uint8Array(16),c=new Uint8Array(64);for(a=0;a<16;a++)s[a]=0;for(a=0;a<8;a++)s[a]=n[a];for(;r>=64;){for(v(c,s,o,w),a=0;a<64;a++)e[t+a]=c[a];for(i=1,a=8;a<16;a++)i=i+(255&s[a])|0,s[a]=255&i,i>>>=8;r-=64,t+=64}if(r>0)for(v(c,s,o,w),a=0;a<r;a++)e[t+a]=c[a];return 0}function x(e,t,r,n,o){var i=new Uint8Array(32);m(i,n,o,w);for(var a=new Uint8Array(8),s=0;s<8;s++)a[s]=n[s+16];return _(e,t,r,a,i)}function E(e,t,r,n,o,i,a){var s=new Uint8Array(32);m(s,i,a,w);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=i[u+16];return b(e,t,r,n,o,c,s)}var k=function(e){var t,r,n,o,i,a,s,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),o=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|o<<9),i=255&e[8]|(255&e[9])<<8,this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,a=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(i>>>14|a<<2),s=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(a>>>11|s<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(s>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function B(e,t,r,n,o,i){var a=new k(i);return a.update(r,n,o),a.finish(e,t),0}function P(e,t,r,n,o,i){var a=new Uint8Array(16);return B(a,0,r,n,o,i),g(e,t,a,0)}function S(e,t,r,n,o){var i;if(r<32)return-1;for(E(e,0,t,0,r,n,o),B(e,16,e,32,r-32,e),i=0;i<16;i++)e[i]=0;return 0}function U(e,t,r,n,o){var i,a=new Uint8Array(32);if(r<32)return-1;if(x(a,0,32,n,o),0!==P(t,16,t,32,r-32,a))return-1;for(E(e,0,t,0,r,n,o),i=0;i<32;i++)e[i]=0;return 0}function M(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function I(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function R(e,t,r){for(var n,o=~(r-1),i=0;i<16;i++)n=o&(e[i]^t[i]),e[i]^=n,t[i]^=n}function C(e,r){var n,o,i,a=t(),s=t();for(n=0;n<16;n++)s[n]=r[n];for(I(s),I(s),I(s),o=0;o<2;o++){for(a[0]=s[0]-65517,n=1;n<15;n++)a[n]=s[n]-65535-(a[n-1]>>16&1),a[n-1]&=65535;a[15]=s[15]-32767-(a[14]>>16&1),i=a[15]>>16&1,a[14]&=65535,R(s,a,1-i)}for(n=0;n<16;n++)e[2*n]=255&s[n],e[2*n+1]=s[n]>>8}function N(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return C(r,e),C(n,t),y(r,0,n,0)}function L(e){var t=new Uint8Array(32);return C(t,e),1&t[0]}function D(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function O(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function H(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function F(e,t,r){var n,o,i=0,a=0,s=0,c=0,u=0,f=0,l=0,h=0,d=0,p=0,g=0,y=0,v=0,m=0,w=0,b=0,_=0,x=0,E=0,k=0,T=0,A=0,B=0,P=0,S=0,U=0,M=0,I=0,R=0,C=0,N=0,L=r[0],D=r[1],O=r[2],H=r[3],F=r[4],K=r[5],W=r[6],j=r[7],z=r[8],V=r[9],q=r[10],G=r[11],Y=r[12],J=r[13],Z=r[14],$=r[15];i+=(n=t[0])*L,a+=n*D,s+=n*O,c+=n*H,u+=n*F,f+=n*K,l+=n*W,h+=n*j,d+=n*z,p+=n*V,g+=n*q,y+=n*G,v+=n*Y,m+=n*J,w+=n*Z,b+=n*$,a+=(n=t[1])*L,s+=n*D,c+=n*O,u+=n*H,f+=n*F,l+=n*K,h+=n*W,d+=n*j,p+=n*z,g+=n*V,y+=n*q,v+=n*G,m+=n*Y,w+=n*J,b+=n*Z,_+=n*$,s+=(n=t[2])*L,c+=n*D,u+=n*O,f+=n*H,l+=n*F,h+=n*K,d+=n*W,p+=n*j,g+=n*z,y+=n*V,v+=n*q,m+=n*G,w+=n*Y,b+=n*J,_+=n*Z,x+=n*$,c+=(n=t[3])*L,u+=n*D,f+=n*O,l+=n*H,h+=n*F,d+=n*K,p+=n*W,g+=n*j,y+=n*z,v+=n*V,m+=n*q,w+=n*G,b+=n*Y,_+=n*J,x+=n*Z,E+=n*$,u+=(n=t[4])*L,f+=n*D,l+=n*O,h+=n*H,d+=n*F,p+=n*K,g+=n*W,y+=n*j,v+=n*z,m+=n*V,w+=n*q,b+=n*G,_+=n*Y,x+=n*J,E+=n*Z,k+=n*$,f+=(n=t[5])*L,l+=n*D,h+=n*O,d+=n*H,p+=n*F,g+=n*K,y+=n*W,v+=n*j,m+=n*z,w+=n*V,b+=n*q,_+=n*G,x+=n*Y,E+=n*J,k+=n*Z,T+=n*$,l+=(n=t[6])*L,h+=n*D,d+=n*O,p+=n*H,g+=n*F,y+=n*K,v+=n*W,m+=n*j,w+=n*z,b+=n*V,_+=n*q,x+=n*G,E+=n*Y,k+=n*J,T+=n*Z,A+=n*$,h+=(n=t[7])*L,d+=n*D,p+=n*O,g+=n*H,y+=n*F,v+=n*K,m+=n*W,w+=n*j,b+=n*z,_+=n*V,x+=n*q,E+=n*G,k+=n*Y,T+=n*J,A+=n*Z,B+=n*$,d+=(n=t[8])*L,p+=n*D,g+=n*O,y+=n*H,v+=n*F,m+=n*K,w+=n*W,b+=n*j,_+=n*z,x+=n*V,E+=n*q,k+=n*G,T+=n*Y,A+=n*J,B+=n*Z,P+=n*$,p+=(n=t[9])*L,g+=n*D,y+=n*O,v+=n*H,m+=n*F,w+=n*K,b+=n*W,_+=n*j,x+=n*z,E+=n*V,k+=n*q,T+=n*G,A+=n*Y,B+=n*J,P+=n*Z,S+=n*$,g+=(n=t[10])*L,y+=n*D,v+=n*O,m+=n*H,w+=n*F,b+=n*K,_+=n*W,x+=n*j,E+=n*z,k+=n*V,T+=n*q,A+=n*G,B+=n*Y,P+=n*J,S+=n*Z,U+=n*$,y+=(n=t[11])*L,v+=n*D,m+=n*O,w+=n*H,b+=n*F,_+=n*K,x+=n*W,E+=n*j,k+=n*z,T+=n*V,A+=n*q,B+=n*G,P+=n*Y,S+=n*J,U+=n*Z,M+=n*$,v+=(n=t[12])*L,m+=n*D,w+=n*O,b+=n*H,_+=n*F,x+=n*K,E+=n*W,k+=n*j,T+=n*z,A+=n*V,B+=n*q,P+=n*G,S+=n*Y,U+=n*J,M+=n*Z,I+=n*$,m+=(n=t[13])*L,w+=n*D,b+=n*O,_+=n*H,x+=n*F,E+=n*K,k+=n*W,T+=n*j,A+=n*z,B+=n*V,P+=n*q,S+=n*G,U+=n*Y,M+=n*J,I+=n*Z,R+=n*$,w+=(n=t[14])*L,b+=n*D,_+=n*O,x+=n*H,E+=n*F,k+=n*K,T+=n*W,A+=n*j,B+=n*z,P+=n*V,S+=n*q,U+=n*G,M+=n*Y,I+=n*J,R+=n*Z,C+=n*$,b+=(n=t[15])*L,a+=38*(x+=n*O),s+=38*(E+=n*H),c+=38*(k+=n*F),u+=38*(T+=n*K),f+=38*(A+=n*W),l+=38*(B+=n*j),h+=38*(P+=n*z),d+=38*(S+=n*V),p+=38*(U+=n*q),g+=38*(M+=n*G),y+=38*(I+=n*Y),v+=38*(R+=n*J),m+=38*(C+=n*Z),w+=38*(N+=n*$),i=(n=(i+=38*(_+=n*D))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),a=(n=a+o+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),v=(n=v+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),i=(n=(i+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),a=(n=a+o+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),v=(n=v+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),i+=o-1+37*(o-1),e[0]=i,e[1]=a,e[2]=s,e[3]=c,e[4]=u,e[5]=f,e[6]=l,e[7]=h,e[8]=d,e[9]=p,e[10]=g,e[11]=y,e[12]=v,e[13]=m,e[14]=w,e[15]=b}function K(e,t){F(e,t,t)}function W(e,r){var n,o=t();for(n=0;n<16;n++)o[n]=r[n];for(n=253;n>=0;n--)K(o,o),2!==n&&4!==n&&F(o,o,r);for(n=0;n<16;n++)e[n]=o[n]}function j(e,r){var n,o=t();for(n=0;n<16;n++)o[n]=r[n];for(n=250;n>=0;n--)K(o,o),1!==n&&F(o,o,r);for(n=0;n<16;n++)e[n]=o[n]}function z(e,r,n){var o,i,a=new Uint8Array(32),c=new Float64Array(80),u=t(),f=t(),l=t(),h=t(),d=t(),p=t();for(i=0;i<31;i++)a[i]=r[i];for(a[31]=127&r[31]|64,a[0]&=248,D(c,n),i=0;i<16;i++)f[i]=c[i],h[i]=u[i]=l[i]=0;for(u[0]=h[0]=1,i=254;i>=0;--i)R(u,f,o=a[i>>>3]>>>(7&i)&1),R(l,h,o),O(d,u,l),H(u,u,l),O(l,f,h),H(f,f,h),K(h,d),K(p,u),F(u,l,u),F(l,f,d),O(d,u,l),H(u,u,l),K(f,u),H(l,h,p),F(u,l,s),O(u,u,h),F(l,l,u),F(u,h,p),F(h,f,c),K(f,d),R(u,f,o),R(l,h,o);for(i=0;i<16;i++)c[i+16]=u[i],c[i+32]=l[i],c[i+48]=f[i],c[i+64]=h[i];var g=c.subarray(32),y=c.subarray(16);return W(g,g),F(y,y,g),C(e,y),0}function V(e,t){return z(e,t,o)}function q(e,t){return r(t,32),V(e,t)}function G(e,t,r){var o=new Uint8Array(32);return z(o,r,t),m(e,n,o,w)}k.prototype.blocks=function(e,t,r){for(var n,o,i,a,s,c,u,f,l,h,d,p,g,y,v,m,w,b,_,x=this.fin?0:2048,E=this.h[0],k=this.h[1],T=this.h[2],A=this.h[3],B=this.h[4],P=this.h[5],S=this.h[6],U=this.h[7],M=this.h[8],I=this.h[9],R=this.r[0],C=this.r[1],N=this.r[2],L=this.r[3],D=this.r[4],O=this.r[5],H=this.r[6],F=this.r[7],K=this.r[8],W=this.r[9];r>=16;)h=l=0,h+=(E+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*R,h+=(k+=8191&(n>>>13|(o=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*W),h+=(T+=8191&(o>>>10|(i=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*K),h+=(A+=8191&(i>>>7|(a=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*F),l=(h+=(B+=8191&(a>>>4|(s=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*H))>>>13,h&=8191,h+=(P+=s>>>1&8191)*(5*O),h+=(S+=8191&(s>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*D),h+=(U+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*L),h+=(M+=8191&(u>>>8|(f=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*N),d=l+=(h+=(I+=f>>>5|x)*(5*C))>>>13,d+=E*C,d+=k*R,d+=T*(5*W),d+=A*(5*K),l=(d+=B*(5*F))>>>13,d&=8191,d+=P*(5*H),d+=S*(5*O),d+=U*(5*D),d+=M*(5*L),l+=(d+=I*(5*N))>>>13,d&=8191,p=l,p+=E*N,p+=k*C,p+=T*R,p+=A*(5*W),l=(p+=B*(5*K))>>>13,p&=8191,p+=P*(5*F),p+=S*(5*H),p+=U*(5*O),p+=M*(5*D),g=l+=(p+=I*(5*L))>>>13,g+=E*L,g+=k*N,g+=T*C,g+=A*R,l=(g+=B*(5*W))>>>13,g&=8191,g+=P*(5*K),g+=S*(5*F),g+=U*(5*H),g+=M*(5*O),y=l+=(g+=I*(5*D))>>>13,y+=E*D,y+=k*L,y+=T*N,y+=A*C,l=(y+=B*R)>>>13,y&=8191,y+=P*(5*W),y+=S*(5*K),y+=U*(5*F),y+=M*(5*H),v=l+=(y+=I*(5*O))>>>13,v+=E*O,v+=k*D,v+=T*L,v+=A*N,l=(v+=B*C)>>>13,v&=8191,v+=P*R,v+=S*(5*W),v+=U*(5*K),v+=M*(5*F),m=l+=(v+=I*(5*H))>>>13,m+=E*H,m+=k*O,m+=T*D,m+=A*L,l=(m+=B*N)>>>13,m&=8191,m+=P*C,m+=S*R,m+=U*(5*W),m+=M*(5*K),w=l+=(m+=I*(5*F))>>>13,w+=E*F,w+=k*H,w+=T*O,w+=A*D,l=(w+=B*L)>>>13,w&=8191,w+=P*N,w+=S*C,w+=U*R,w+=M*(5*W),b=l+=(w+=I*(5*K))>>>13,b+=E*K,b+=k*F,b+=T*H,b+=A*O,l=(b+=B*D)>>>13,b&=8191,b+=P*L,b+=S*N,b+=U*C,b+=M*R,_=l+=(b+=I*(5*W))>>>13,_+=E*W,_+=k*K,_+=T*F,_+=A*H,l=(_+=B*O)>>>13,_&=8191,_+=P*D,_+=S*L,_+=U*N,_+=M*C,E=h=8191&(l=(l=((l+=(_+=I*R)>>>13)<<2)+l|0)+(h&=8191)|0),k=d+=l>>>=13,T=p&=8191,A=g&=8191,B=y&=8191,P=v&=8191,S=m&=8191,U=w&=8191,M=b&=8191,I=_&=8191,t+=16,r-=16;this.h[0]=E,this.h[1]=k,this.h[2]=T,this.h[3]=A,this.h[4]=B,this.h[5]=P,this.h[6]=S,this.h[7]=U,this.h[8]=M,this.h[9]=I},k.prototype.finish=function(e,t){var r,n,o,i,a=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=r,r=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,a[0]=this.h[0]+5,r=a[0]>>>13,a[0]&=8191,i=1;i<10;i++)a[i]=this.h[i]+r,r=a[i]>>>13,a[i]&=8191;for(a[9]-=8192,n=(1^r)-1,i=0;i<10;i++)a[i]&=n;for(n=~n,i=0;i<10;i++)this.h[i]=this.h[i]&n|a[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,i=1;i<8;i++)o=(this.h[i]+this.pad[i]|0)+(o>>>16)|0,this.h[i]=65535&o;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},k.prototype.update=function(e,t,r){var n,o;if(this.leftover){for((o=16-this.leftover)>r&&(o=r),n=0;n<o;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=o,t+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(o=r-r%16,this.blocks(e,t,o),t+=o,r-=o),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var Y=S,J=U,Z=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function $(e,t,r,n){for(var o,i,a,s,c,u,f,l,h,d,p,g,y,v,m,w,b,_,x,E,k,T,A,B,P,S,U=new Int32Array(16),M=new Int32Array(16),I=e[0],R=e[1],C=e[2],N=e[3],L=e[4],D=e[5],O=e[6],H=e[7],F=t[0],K=t[1],W=t[2],j=t[3],z=t[4],V=t[5],q=t[6],G=t[7],Y=0;n>=128;){for(x=0;x<16;x++)E=8*x+Y,U[x]=r[E+0]<<24|r[E+1]<<16|r[E+2]<<8|r[E+3],M[x]=r[E+4]<<24|r[E+5]<<16|r[E+6]<<8|r[E+7];for(x=0;x<80;x++)if(o=I,i=R,a=C,s=N,c=L,u=D,f=O,h=F,d=K,p=W,g=j,y=z,v=V,m=q,A=65535&(T=G),B=T>>>16,P=65535&(k=H),S=k>>>16,A+=65535&(T=(z>>>14|L<<18)^(z>>>18|L<<14)^(L>>>9|z<<23)),B+=T>>>16,P+=65535&(k=(L>>>14|z<<18)^(L>>>18|z<<14)^(z>>>9|L<<23)),S+=k>>>16,A+=65535&(T=z&V^~z&q),B+=T>>>16,P+=65535&(k=L&D^~L&O),S+=k>>>16,A+=65535&(T=Z[2*x+1]),B+=T>>>16,P+=65535&(k=Z[2*x]),S+=k>>>16,k=U[x%16],B+=(T=M[x%16])>>>16,P+=65535&k,S+=k>>>16,P+=(B+=(A+=65535&T)>>>16)>>>16,A=65535&(T=_=65535&A|B<<16),B=T>>>16,P=65535&(k=b=65535&P|(S+=P>>>16)<<16),S=k>>>16,A+=65535&(T=(F>>>28|I<<4)^(I>>>2|F<<30)^(I>>>7|F<<25)),B+=T>>>16,P+=65535&(k=(I>>>28|F<<4)^(F>>>2|I<<30)^(F>>>7|I<<25)),S+=k>>>16,B+=(T=F&K^F&W^K&W)>>>16,P+=65535&(k=I&R^I&C^R&C),S+=k>>>16,l=65535&(P+=(B+=(A+=65535&T)>>>16)>>>16)|(S+=P>>>16)<<16,w=65535&A|B<<16,A=65535&(T=g),B=T>>>16,P=65535&(k=s),S=k>>>16,B+=(T=_)>>>16,P+=65535&(k=b),S+=k>>>16,R=o,C=i,N=a,L=s=65535&(P+=(B+=(A+=65535&T)>>>16)>>>16)|(S+=P>>>16)<<16,D=c,O=u,H=f,I=l,K=h,W=d,j=p,z=g=65535&A|B<<16,V=y,q=v,G=m,F=w,x%16==15)for(E=0;E<16;E++)k=U[E],A=65535&(T=M[E]),B=T>>>16,P=65535&k,S=k>>>16,k=U[(E+9)%16],A+=65535&(T=M[(E+9)%16]),B+=T>>>16,P+=65535&k,S+=k>>>16,b=U[(E+1)%16],A+=65535&(T=((_=M[(E+1)%16])>>>1|b<<31)^(_>>>8|b<<24)^(_>>>7|b<<25)),B+=T>>>16,P+=65535&(k=(b>>>1|_<<31)^(b>>>8|_<<24)^b>>>7),S+=k>>>16,b=U[(E+14)%16],B+=(T=((_=M[(E+14)%16])>>>19|b<<13)^(b>>>29|_<<3)^(_>>>6|b<<26))>>>16,P+=65535&(k=(b>>>19|_<<13)^(_>>>29|b<<3)^b>>>6),S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,U[E]=65535&P|S<<16,M[E]=65535&A|B<<16;A=65535&(T=F),B=T>>>16,P=65535&(k=I),S=k>>>16,k=e[0],B+=(T=t[0])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[0]=I=65535&P|S<<16,t[0]=F=65535&A|B<<16,A=65535&(T=K),B=T>>>16,P=65535&(k=R),S=k>>>16,k=e[1],B+=(T=t[1])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[1]=R=65535&P|S<<16,t[1]=K=65535&A|B<<16,A=65535&(T=W),B=T>>>16,P=65535&(k=C),S=k>>>16,k=e[2],B+=(T=t[2])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[2]=C=65535&P|S<<16,t[2]=W=65535&A|B<<16,A=65535&(T=j),B=T>>>16,P=65535&(k=N),S=k>>>16,k=e[3],B+=(T=t[3])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[3]=N=65535&P|S<<16,t[3]=j=65535&A|B<<16,A=65535&(T=z),B=T>>>16,P=65535&(k=L),S=k>>>16,k=e[4],B+=(T=t[4])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[4]=L=65535&P|S<<16,t[4]=z=65535&A|B<<16,A=65535&(T=V),B=T>>>16,P=65535&(k=D),S=k>>>16,k=e[5],B+=(T=t[5])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[5]=D=65535&P|S<<16,t[5]=V=65535&A|B<<16,A=65535&(T=q),B=T>>>16,P=65535&(k=O),S=k>>>16,k=e[6],B+=(T=t[6])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[6]=O=65535&P|S<<16,t[6]=q=65535&A|B<<16,A=65535&(T=G),B=T>>>16,P=65535&(k=H),S=k>>>16,k=e[7],B+=(T=t[7])>>>16,P+=65535&k,S+=k>>>16,S+=(P+=(B+=(A+=65535&T)>>>16)>>>16)>>>16,e[7]=H=65535&P|S<<16,t[7]=G=65535&A|B<<16,Y+=128,n-=128}return n}function X(e,t,r){var n,o=new Int32Array(8),i=new Int32Array(8),a=new Uint8Array(256),s=r;for(o[0]=1779033703,o[1]=3144134277,o[2]=1013904242,o[3]=2773480762,o[4]=1359893119,o[5]=2600822924,o[6]=528734635,o[7]=1541459225,i[0]=4089235720,i[1]=2227873595,i[2]=4271175723,i[3]=1595750129,i[4]=2917565137,i[5]=725511199,i[6]=4215389547,i[7]=327033209,$(o,i,t,r),r%=128,n=0;n<r;n++)a[n]=t[s-r+n];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,d(a,r-8,s/536870912|0,s<<3),$(o,i,a,r),n=0;n<8;n++)d(e,8*n,o[n],i[n]);return 0}function Q(e,r){var n=t(),o=t(),i=t(),a=t(),s=t(),c=t(),f=t(),l=t(),h=t();H(n,e[1],e[0]),H(h,r[1],r[0]),F(n,n,h),O(o,e[0],e[1]),O(h,r[0],r[1]),F(o,o,h),F(i,e[3],r[3]),F(i,i,u),F(a,e[2],r[2]),O(a,a,a),H(s,o,n),H(c,a,i),O(f,a,i),O(l,o,n),F(e[0],s,c),F(e[1],l,f),F(e[2],f,c),F(e[3],s,l)}function ee(e,t,r){var n;for(n=0;n<4;n++)R(e[n],t[n],r)}function te(e,r){var n=t(),o=t(),i=t();W(i,r[2]),F(n,r[0],i),F(o,r[1],i),C(e,o),e[31]^=L(n)<<7}function re(e,t,r){var n,o;for(M(e[0],i),M(e[1],a),M(e[2],a),M(e[3],i),o=255;o>=0;--o)ee(e,t,n=r[o/8|0]>>(7&o)&1),Q(t,e),Q(e,e),ee(e,t,n)}function ne(e,r){var n=[t(),t(),t(),t()];M(n[0],f),M(n[1],l),M(n[2],a),F(n[3],f,l),re(e,n,r)}function oe(e,n,o){var i,a=new Uint8Array(64),s=[t(),t(),t(),t()];for(o||r(n,32),X(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64,ne(s,a),te(e,s),i=0;i<32;i++)n[i+32]=e[i];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ae(e,t){var r,n,o,i;for(n=63;n>=32;--n){for(r=0,o=n-32,i=n-12;o<i;++o)t[o]+=r-16*t[n]*ie[o-(n-32)],r=Math.floor((t[o]+128)/256),t[o]-=256*r;t[o]+=r,t[n]=0}for(r=0,o=0;o<32;o++)t[o]+=r-(t[31]>>4)*ie[o],r=t[o]>>8,t[o]&=255;for(o=0;o<32;o++)t[o]-=r*ie[o];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function se(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ae(e,r)}function ce(e,r,n,o){var i,a,s=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),f=new Float64Array(64),l=[t(),t(),t(),t()];X(s,o,32),s[0]&=248,s[31]&=127,s[31]|=64;var h=n+64;for(i=0;i<n;i++)e[64+i]=r[i];for(i=0;i<32;i++)e[32+i]=s[32+i];for(X(u,e.subarray(32),n+32),se(u),ne(l,u),te(e,l),i=32;i<64;i++)e[i]=o[i];for(X(c,e,n+64),se(c),i=0;i<64;i++)f[i]=0;for(i=0;i<32;i++)f[i]=u[i];for(i=0;i<32;i++)for(a=0;a<32;a++)f[i+a]+=c[i]*s[a];return ae(e.subarray(32),f),h}function ue(e,r,n,o){var s,u=new Uint8Array(32),f=new Uint8Array(64),l=[t(),t(),t(),t()],d=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),o=t(),s=t(),u=t(),f=t(),l=t(),d=t();return M(e[2],a),D(e[1],r),K(s,e[1]),F(u,s,c),H(s,s,e[2]),O(u,e[2],u),K(f,u),K(l,f),F(d,l,f),F(n,d,s),F(n,n,u),j(n,n),F(n,n,s),F(n,n,u),F(n,n,u),F(e[0],n,u),K(o,e[0]),F(o,o,u),N(o,s)&&F(e[0],e[0],h),K(o,e[0]),F(o,o,u),N(o,s)?-1:(L(e[0])===r[31]>>7&&H(e[0],i,e[0]),F(e[3],e[0],e[1]),0)}(d,o))return-1;for(s=0;s<n;s++)e[s]=r[s];for(s=0;s<32;s++)e[s+32]=o[s];if(X(f,e,n),se(f),re(l,d,f),ne(d,r.subarray(32)),Q(l,d),te(u,l),n-=64,y(r,0,u,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=r[s+64];return n}var fe,le=16,he=64,de=32,pe=64;function ge(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function ye(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ve(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:m,crypto_stream_xor:E,crypto_stream:x,crypto_stream_salsa20_xor:b,crypto_stream_salsa20:_,crypto_onetimeauth:B,crypto_onetimeauth_verify:P,crypto_verify_16:g,crypto_verify_32:y,crypto_secretbox:S,crypto_secretbox_open:U,crypto_scalarmult:z,crypto_scalarmult_base:V,crypto_box_beforenm:G,crypto_box_afternm:Y,crypto_box:function(e,t,r,n,o,i){var a=new Uint8Array(32);return G(a,o,i),Y(e,t,r,n,a)},crypto_box_open:function(e,t,r,n,o,i){var a=new Uint8Array(32);return G(a,o,i),J(e,t,r,n,a)},crypto_box_keypair:q,crypto_hash:X,crypto_sign:ce,crypto_sign_keypair:oe,crypto_sign_open:ue,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:le,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:he,crypto_sign_PUBLICKEYBYTES:de,crypto_sign_SECRETKEYBYTES:pe,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:c,L:ie,pack25519:C,unpack25519:D,M:F,A:O,S:K,Z:H,pow2523:j,add:Q,set25519:M,modL:ae,scalarmult:re,scalarbase:ne},e.randomBytes=function(e){var t=new Uint8Array(e);return r(t,e),t},e.secretbox=function(e,t,r){ye(e,t,r),ge(r,t);for(var n=new Uint8Array(32+e.length),o=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+32]=e[i];return S(o,n,n.length,t,r),o.subarray(le)},e.secretbox.open=function(e,t,r){ye(e,t,r),ge(r,t);for(var n=new Uint8Array(le+e.length),o=new Uint8Array(n.length),i=0;i<e.length;i++)n[i+le]=e[i];return n.length<32||0!==U(o,n,n.length,t,r)?null:o.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=le,e.scalarMult=function(e,t){if(ye(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return z(r,e,t),r},e.scalarMult.base=function(e){if(ye(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return V(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,o){var i=e.box.before(n,o);return e.secretbox(t,r,i)},e.box.before=function(e,t){ye(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return G(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,o){var i=e.box.before(n,o);return e.secretbox.open(t,r,i)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return q(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(ye(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return V(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(ye(e,t),t.length!==pe)throw new Error("bad secret key size");var r=new Uint8Array(he+e.length);return ce(r,e,e.length,t),r},e.sign.open=function(e,t){if(ye(e,t),t.length!==de)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ue(r,e,e.length,t);if(n<0)return null;for(var o=new Uint8Array(n),i=0;i<o.length;i++)o[i]=r[i];return o},e.sign.detached=function(t,r){for(var n=e.sign(t,r),o=new Uint8Array(he),i=0;i<o.length;i++)o[i]=n[i];return o},e.sign.detached.verify=function(e,t,r){if(ye(e,t,r),t.length!==he)throw new Error("bad signature size");if(r.length!==de)throw new Error("bad public key size");var n,o=new Uint8Array(he+e.length),i=new Uint8Array(he+e.length);for(n=0;n<he;n++)o[n]=t[n];for(n=0;n<e.length;n++)o[n+he]=e[n];return ue(i,o,o.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(de),t=new Uint8Array(pe);return oe(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(ye(e),e.length!==pe)throw new Error("bad secret key size");for(var t=new Uint8Array(de),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(ye(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(de),r=new Uint8Array(pe),n=0;n<32;n++)r[n]=e[n];return oe(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=de,e.sign.secretKeyLength=pe,e.sign.seedLength=32,e.sign.signatureLength=he,e.hash=function(e){ye(e);var t=new Uint8Array(64);return X(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return ye(e,t),0!==e.length&&0!==t.length&&e.length===t.length&&0===p(e,0,t,0,e.length)},e.setPRNG=function(e){r=e},(fe="undefined"!=typeof self?self.crypto||self.msCrypto:null)&&fe.getRandomValues?e.setPRNG((function(e,t){var r,n=new Uint8Array(t);for(r=0;r<t;r+=65536)fe.getRandomValues(n.subarray(r,r+Math.min(t-r,65536)));for(r=0;r<t;r++)e[r]=n[r];ve(n)})):void 0!==A&&(fe=T)&&fe.randomBytes&&e.setPRNG((function(e,t){var r,n=fe.randomBytes(t);for(r=0;r<t;r++)e[r]=n[r];ve(n)}))}(Xe.exports?Xe.exports:self.nacl=self.nacl||{});var Qe,et,tt,rt={exports:{}};et=B,tt=function(){var e={};function t(e){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");var t,r=unescape(encodeURIComponent(e)),n=new Uint8Array(r.length);for(t=0;t<r.length;t++)n[t]=r.charCodeAt(t);return n},e.encodeUTF8=function(e){var t,r=[];for(t=0;t<e.length;t++)r.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(r.join("")))},"undefined"==typeof atob?void 0!==Buffer.from?(e.encodeBase64=function(e){return Buffer.from(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(Buffer.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new Buffer(e).toString("base64")},e.decodeBase64=function(e){return t(e),new Uint8Array(Array.prototype.slice.call(new Buffer(e,"base64"),0))}):(e.encodeBase64=function(e){var t,r=[],n=e.length;for(t=0;t<n;t++)r.push(String.fromCharCode(e[t]));return btoa(r.join(""))},e.decodeBase64=function(e){t(e);var r,n=atob(e),o=new Uint8Array(n.length);for(r=0;r<n.length;r++)o[r]=n.charCodeAt(r);return o}),e},(Qe=rt).exports?Qe.exports=tt():(et.nacl||(et.nacl={}),et.nacl.util=tt());var nt=B&&B.__assign||function(){return(nt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(_e,"__esModule",{value:!0});var ot=n,it=$e,at=Xe.exports,st=rt.exports,ct={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]};_e.TYPED_MESSAGE_SCHEMA=ct;var ut={encodeData:function(e,t,r,n){var o=this;void 0===n&&(n=!0);var i=["bytes32"],a=[this.hashType(e,r)];if(n)for(var s=function(e,t,i){if(void 0!==r[t])return["bytes32",null==i?"0x0000000000000000000000000000000000000000000000000000000000000000":ot.sha3(o.encodeData(t,i,r,n))];if(void 0===i)throw new Error("missing value for field "+e+" of type "+t);if("bytes"===t)return["bytes32",ot.sha3(i)];if("string"===t)return"string"==typeof i&&(i=Buffer.from(i,"utf8")),["bytes32",ot.sha3(i)];if(t.lastIndexOf("]")===t.length-1){var a=t.slice(0,t.lastIndexOf("[")),c=i.map((function(t){return s(e,a,t)}));return["bytes32",ot.sha3(it.rawEncode(c.map((function(e){return e[0]})),c.map((function(e){return e[1]}))))]}return[t,i]},c=0,u=r[e];c<u.length;c++){var f=u[c],l=s(f.name,f.type,t[f.name]),h=l[0],d=l[1];i.push(h),a.push(d)}else for(var p=0,g=r[e];p<g.length;p++){if(void 0!==(d=t[(f=g[p]).name]))if("bytes"===f.type)i.push("bytes32"),d=ot.sha3(d),a.push(d);else if("string"===f.type)i.push("bytes32"),"string"==typeof d&&(d=Buffer.from(d,"utf8")),d=ot.sha3(d),a.push(d);else if(void 0!==r[f.type])i.push("bytes32"),d=ot.sha3(this.encodeData(f.type,d,r,n)),a.push(d);else{if(f.type.lastIndexOf("]")===f.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");i.push(f.type),a.push(d)}}return it.rawEncode(i,a)},encodeType:function(e,t){for(var r="",n=this.findTypeDependencies(e,t).filter((function(t){return t!==e})),o=0,i=n=[e].concat(n.sort());o<i.length;o++){var a=i[o];if(!t[a])throw new Error("No type definition specified: "+a);r+=a+"("+t[a].map((function(e){var t=e.name;return e.type+" "+t})).join(",")+")"}return r},findTypeDependencies:function(e,t,r){if(void 0===r&&(r=[]),e=e.match(/^\w*/u)[0],r.includes(e)||void 0===t[e])return r;r.push(e);for(var n=0,o=t[e];n<o.length;n++)for(var i=o[n],a=0,s=this.findTypeDependencies(i.type,t,r);a<s.length;a++){var c=s[a];!r.includes(c)&&r.push(c)}return r},hashStruct:function(e,t,r,n){return void 0===n&&(n=!0),ot.sha3(this.encodeData(e,t,r,n))},hashType:function(e,t){return ot.sha3(this.encodeType(e,t))},sanitizeData:function(e){var t={};for(var r in ct.properties)e[r]&&(t[r]=e[r]);return"types"in t&&(t.types=nt({EIP712Domain:[]},t.types)),t},sign:function(e,t){void 0===t&&(t=!0);var r=this.sanitizeData(e),n=[Buffer.from("1901","hex")];return n.push(this.hashStruct("EIP712Domain",r.domain,r.types,t)),"EIP712Domain"!==r.primaryType&&n.push(this.hashStruct(r.primaryType,r.message,r.types,t)),ot.sha3(Buffer.concat(n))}};function ft(e,t,r){var n=ot.fromSigned(t),o=ot.fromSigned(r),i=ot.bufferToInt(e),a=xt(ot.toUnsigned(n).toString("hex"),64),s=xt(ot.toUnsigned(o).toString("hex"),64),c=ot.stripHexPrefix(ot.intToHex(i));return ot.addHexPrefix(a.concat(s,c)).toString("hex")}function lt(e,t){var r=wt(t.data),n=ot.ecsign(r,e);return ot.bufferToHex(ft(n.v,n.r,n.s))}function ht(e){var t=bt(wt(e.data),e.sig),r=ot.publicToAddress(t);return ot.bufferToHex(r)}function dt(e,t,r){switch(r){case"x25519-xsalsa20-poly1305":if("string"!=typeof t.data)throw new Error('Cannot detect secret message, message params should be of the form {data: "secret message"} ');var n=at.box.keyPair(),o=void 0;try{o=st.decodeBase64(e)}catch(c){throw new Error("Bad public key")}var i=st.decodeUTF8(t.data),a=at.randomBytes(at.box.nonceLength),s=at.box(i,a,o,n.secretKey);return{version:"x25519-xsalsa20-poly1305",nonce:st.encodeBase64(a),ephemPublicKey:st.encodeBase64(n.publicKey),ciphertext:st.encodeBase64(s)};default:throw new Error("Encryption type/version not supported")}}function pt(e,t){switch(e.version){case"x25519-xsalsa20-poly1305":var r=Et(t),n=at.box.keyPair.fromSecretKey(r).secretKey,o=st.decodeBase64(e.nonce),i=st.decodeBase64(e.ciphertext),a=st.decodeBase64(e.ephemPublicKey),s=at.box.open(i,o,a,n),c=void 0;try{c=st.encodeUTF8(s)}catch(u){throw new Error("Decryption failed.")}if(c)return c;throw new Error("Decryption failed.");default:throw new Error("Encryption type/version not supported.")}}function gt(e,t){var r=ut.sign(t.data,!1),n=ot.ecsign(r,e);return ot.bufferToHex(ft(n.v,n.r,n.s))}function yt(e,t){var r=ut.sign(t.data),n=ot.ecsign(r,e);return ot.bufferToHex(ft(n.v,n.r,n.s))}function vt(e){var t=bt(ut.sign(e.data,!1),e.sig),r=ot.publicToAddress(t);return ot.bufferToHex(r)}function mt(e){var t=bt(ut.sign(e.data),e.sig),r=ot.publicToAddress(t);return ot.bufferToHex(r)}function wt(e){var t=new Error("Expect argument to be non-empty array");if("object"!=typeof e||!("length"in e)||!e.length)throw t;var r=e.map((function(e){return"bytes"===e.type?ot.toBuffer(e.value):e.value})),n=e.map((function(e){return e.type})),o=e.map((function(e){if(!e.name)throw t;return e.type+" "+e.name}));return it.soliditySHA3(["bytes32","bytes32"],[it.soliditySHA3(new Array(e.length).fill("string"),o),it.soliditySHA3(n,r)])}function bt(e,t){var r=ot.toBuffer(t),n=ot.fromRpcSig(r);return ot.ecrecover(e,n.v,n.r,n.s)}function _t(e){var t=ot.toBuffer(e.data);return bt(ot.hashPersonalMessage(t),e.sig)}function xt(e,t){for(var r=""+e;r.length<t;)r="0"+r;return r}function Et(e){var t=Buffer.from(e,"hex").toString("base64");return st.decodeBase64(t)}_e.TypedDataUtils=ut,_e.concatSig=ft,_e.normalize=function(e){if(e){if("number"==typeof e){var t=ot.toBuffer(e);e=ot.bufferToHex(t)}if("string"!=typeof e){var r="eth-sig-util.normalize() requires hex string or integer input.";throw new Error(r+=" received "+typeof e+": "+e)}return ot.addHexPrefix(e.toLowerCase())}},_e.personalSign=function(e,t){var r=ot.toBuffer(t.data),n=ot.hashPersonalMessage(r),o=ot.ecsign(n,e);return ot.bufferToHex(ft(o.v,o.r,o.s))},_e.recoverPersonalSignature=function(e){var t=_t(e),r=ot.publicToAddress(t);return ot.bufferToHex(r)},_e.extractPublicKey=function(e){return"0x"+_t(e).toString("hex")},_e.typedSignatureHash=function(e){var t=wt(e);return ot.bufferToHex(t)},_e.signTypedDataLegacy=lt,_e.recoverTypedSignatureLegacy=ht,_e.encrypt=dt,_e.encryptSafely=function(e,t,r){var n=Math.pow(2,11),o=t.data;if(!o)throw new Error("Cannot encrypt empty msg.data");if("object"==typeof o&&"toJSON"in o)throw new Error("Cannot encrypt with toJSON property.  Please remove toJSON property");var i={data:o,padding:""},a=Buffer.byteLength(JSON.stringify(i),"utf-8")%n,s=0;return a>0&&(s=n-a-16),i.padding="0".repeat(s),dt(e,{data:JSON.stringify(i)},r)},_e.decrypt=pt,_e.decryptSafely=function(e,t){return JSON.parse(pt(e,t)).data},_e.getEncryptionPublicKey=function(e){var t=Et(e),r=at.box.keyPair.fromSecretKey(t).publicKey;return st.encodeBase64(r)},_e.signTypedMessage=function(e,t,r){switch(void 0===r&&(r="V4"),r){case"V1":return lt(e,t);case"V3":return gt(e,t);case"V4":default:return yt(e,t)}},_e.recoverTypedMessage=function(e,t){switch(void 0===t&&(t="V4"),t){case"V1":return ht(e);case"V3":return vt(e);case"V4":default:return mt(e)}},_e.signTypedData=gt,_e.signTypedData_v4=yt,_e.recoverTypedSignature=vt,_e.recoverTypedSignature_v4=mt;var kt={exports:{}};!function(e,t){var r;r=function(e){setTimeout(e,0)},"undefined"!=typeof process&&process&&"function"==typeof process.nextTick&&(r=process.nextTick),e.exports=function(e){var t={capacity:e||1,current:0,queue:[],firstHere:!1,take:function(){if(!1===t.firstHere){t.current++,t.firstHere=!0;var e=1}else e=0;var r={n:1};"function"==typeof arguments[0]?r.task=arguments[0]:r.n=arguments[0],arguments.length>=2&&("function"==typeof arguments[1]?r.task=arguments[1]:r.n=arguments[1]);var n=r.task;if(r.task=function(){n(t.leave)},t.current+r.n-e>t.capacity)return 1===e&&(t.current--,t.firstHere=!1),t.queue.push(r);t.current+=r.n-e,r.task(t.leave),1===e&&(t.firstHere=!1)},leave:function(e){if(e=e||1,t.current-=e,t.queue.length){var n=t.queue[0];n.n+t.current>t.capacity||(t.queue.shift(),t.current+=n.n,r(n.task))}else if(t.current<0)throw new Error("leave called too many times.")},available:function(e){return e=e||1,t.current+e<=t.capacity}};return t}}(kt);const Tt=L;var At=function(e,t,r){e.sendAsync(Tt({method:"eth_estimateGas",params:[t]}),(function(e,t){if(e)return"no contract code at given address"===e.message?r(null,"0xcf08"):r(e);r(null,t.result)}))};const Bt=me.exports,Pt=we.exports,St=t.inherits,Ut=n,Mt=_e,It=r,Rt=kt.exports,Ct=At,Nt=/^[0-9A-Fa-f]+$/g;var Lt=Dt;function Dt(e){const t=this;t.nonceLock=Rt(1),e.getAccounts&&(t.getAccounts=e.getAccounts),e.processTransaction&&(t.processTransaction=e.processTransaction),e.processMessage&&(t.processMessage=e.processMessage),e.processPersonalMessage&&(t.processPersonalMessage=e.processPersonalMessage),e.processTypedMessage&&(t.processTypedMessage=e.processTypedMessage),e.processTypedMessageV3&&(t.processTypedMessageV3=e.processTypedMessageV3),t.approveTransaction=e.approveTransaction||t.autoApprove,t.approveMessage=e.approveMessage||t.autoApprove,t.approvePersonalMessage=e.approvePersonalMessage||t.autoApprove,t.approveTypedMessage=e.approveTypedMessage||t.autoApprove,t.approveTypedMessageV3=e.approveTypedMessageV3||t.autoApprove,e.signTransaction&&(t.signTransaction=e.signTransaction||Wt("signTransaction")),e.signMessage&&(t.signMessage=e.signMessage||Wt("signMessage")),e.signPersonalMessage&&(t.signPersonalMessage=e.signPersonalMessage||Wt("signPersonalMessage")),e.signTypedMessage&&(t.signTypedMessage=e.signTypedMessage||Wt("signTypedMessage")),e.signTypedMessageV3&&(t.signTypedMessageV3=e.signTypedMessageV3||Wt("signTypedMessageV3")),e.recoverPersonalSignature&&(t.recoverPersonalSignature=e.recoverPersonalSignature),e.publishTransaction&&(t.publishTransaction=e.publishTransaction),t.estimateGas=e.estimateGas||t.estimateGas,t.getGasPrice=e.getGasPrice||t.getGasPrice}function Ot(e){return e.toLowerCase()}function Ht(e){const t=Ut.addHexPrefix(e);return Ut.isValidAddress(t)}function Ft(e){const t=Ut.addHexPrefix(e);return!Ut.isValidAddress(t)&&Kt(e)}function Kt(e){if(!("string"==typeof e))return!1;if(!("0x"===e.slice(0,2)))return!1;return e.slice(2).match(Nt)}function Wt(e){return function(t,r){r(new Error('ProviderEngine - HookedWalletSubprovider - Must provide "'+e+'" fn in constructor options'))}}St(Dt,J),Dt.prototype.handleRequest=function(e,t,r){const n=this;let o,i,a,s,c;switch(n._parityRequests={},n._parityRequestCount=0,e.method){case"eth_coinbase":return void n.getAccounts((function(e,t){if(e)return r(e);let n=t[0]||null;r(null,n)}));case"eth_accounts":return void n.getAccounts((function(e,t){if(e)return r(e);r(null,t)}));case"eth_sendTransaction":return o=e.params[0],void Bt([e=>n.validateTransaction(o,e),e=>n.processTransaction(o,e)],r);case"eth_signTransaction":return o=e.params[0],void Bt([e=>n.validateTransaction(o,e),e=>n.processSignTransaction(o,e)],r);case"eth_sign":return Ft(e.params[1])&&Ht(e.params[0])?(c=e.params[0],s=e.params[1]):(s=e.params[0],c=e.params[1]),a=e.params[2]||{},i=It(a,{from:c,data:s}),void Bt([e=>n.validateMessage(i,e),e=>n.processMessage(i,e)],r);case"personal_sign":return function(){const t=e.params[0];if(Ft(e.params[1])&&Ht(t)){let t="The eth_personalSign method requires params ordered ";t+="[message, address]. This was previously handled incorrectly, ",t+="and has been corrected automatically. ",t+="Please switch this param order for smooth behavior in the future.",console.warn(t),c=e.params[0],s=e.params[1]}else s=e.params[0],c=e.params[1];a=e.params[2]||{},i=It(a,{from:c,data:s}),Bt([e=>n.validatePersonalMessage(i,e),e=>n.processPersonalMessage(i,e)],r)}();case"personal_ecRecover":return function(){s=e.params[0];let t=e.params[1];a=e.params[2]||{},i=It(a,{sig:t,data:s}),n.recoverPersonalSignature(i,r)}();case"eth_signTypedData":return!Ht(e.params[1])&&Ht(e.params[0])?(c=e.params[0],s=e.params[1]):(s=e.params[0],c=e.params[1]),a=e.params[2]||{},i=It(a,{from:c,data:s}),void Bt([e=>n.validateTypedMessage(i,e),e=>n.processTypedMessage(i,e)],r);case"eth_signTypedData_v3":return!Ht(e.params[1])&&Ht(e.params[0])?(c=e.params[0],s=e.params[1]):(s=e.params[0],c=e.params[1]),a=e.params[2]||{},i=It(a,{from:c,data:s}),void Bt([e=>n.validateTypedMessageV3(i,e),e=>n.processTypedMessageV3(i,e)],r);case"parity_postTransaction":return o=e.params[0],void n.parityPostTransaction(o,r);case"parity_postSign":return c=e.params[0],s=e.params[1],void n.parityPostSign(c,s,r);case"parity_checkRequest":return function(){const t=e.params[0];n.parityCheckRequest(t,r)}();case"parity_defaultAccount":return void n.getAccounts((function(e,t){if(e)return r(e);const n=t[0]||null;r(null,n)}));default:return void t()}},Dt.prototype.getAccounts=function(e){e(null,[])},Dt.prototype.processTransaction=function(e,t){const r=this;Bt([t=>r.approveTransaction(e,t),(e,t)=>r.checkApproval("transaction",e,t),t=>r.finalizeAndSubmitTx(e,t)],t)},Dt.prototype.processSignTransaction=function(e,t){const r=this;Bt([t=>r.approveTransaction(e,t),(e,t)=>r.checkApproval("transaction",e,t),t=>r.finalizeTx(e,t)],t)},Dt.prototype.processMessage=function(e,t){const r=this;Bt([t=>r.approveMessage(e,t),(e,t)=>r.checkApproval("message",e,t),t=>r.signMessage(e,t)],t)},Dt.prototype.processPersonalMessage=function(e,t){const r=this;Bt([t=>r.approvePersonalMessage(e,t),(e,t)=>r.checkApproval("message",e,t),t=>r.signPersonalMessage(e,t)],t)},Dt.prototype.processTypedMessage=function(e,t){const r=this;Bt([t=>r.approveTypedMessage(e,t),(e,t)=>r.checkApproval("message",e,t),t=>r.signTypedMessage(e,t)],t)},Dt.prototype.processTypedMessageV3=function(e,t){const r=this;Bt([t=>r.approveTypedMessageV3(e,t),(e,t)=>r.checkApproval("message",e,t),t=>r.signTypedMessageV3(e,t)],t)},Dt.prototype.autoApprove=function(e,t){t(null,!0)},Dt.prototype.checkApproval=function(e,t,r){r(t?null:new Error("User denied "+e+" signature."))},Dt.prototype.parityPostTransaction=function(e,t){const r=this,n=`0x${r._parityRequestCount.toString(16)}`;r._parityRequestCount++,r.emitPayload({method:"eth_sendTransaction",params:[e]},(function(e,t){if(e)return void(r._parityRequests[n]={error:e});const o=t.result;r._parityRequests[n]=o})),t(null,n)},Dt.prototype.parityPostSign=function(e,t,r){const n=this,o=`0x${n._parityRequestCount.toString(16)}`;n._parityRequestCount++,n.emitPayload({method:"eth_sign",params:[e,t]},(function(e,t){if(e)return void(n._parityRequests[o]={error:e});const r=t.result;n._parityRequests[o]=r})),r(null,o)},Dt.prototype.parityCheckRequest=function(e,t){const r=this._parityRequests[e]||null;return r?r.error?t(r.error):void t(null,r):t(null,null)},Dt.prototype.recoverPersonalSignature=function(e,t){let r;try{r=Mt.recoverPersonalSignature(e)}catch(n){return t(n)}t(null,r)},Dt.prototype.validateTransaction=function(e,t){if(void 0===e.from)return t(new Error("Undefined address - from address required to sign transaction."));this.validateSender(e.from,(function(r,n){return r?t(r):n?void t():t(new Error(`Unknown address - unable to sign transaction for this address: "${e.from}"`))}))},Dt.prototype.validateMessage=function(e,t){if(void 0===e.from)return t(new Error("Undefined address - from address required to sign message."));this.validateSender(e.from,(function(r,n){return r?t(r):n?void t():t(new Error(`Unknown address - unable to sign message for this address: "${e.from}"`))}))},Dt.prototype.validatePersonalMessage=function(e,t){return void 0===e.from?t(new Error("Undefined address - from address required to sign personal message.")):void 0===e.data?t(new Error("Undefined message - message required to sign personal message.")):Kt(e.data)?void this.validateSender(e.from,(function(r,n){return r?t(r):n?void t():t(new Error(`Unknown address - unable to sign message for this address: "${e.from}"`))})):t(new Error("HookedWalletSubprovider - validateMessage - message was not encoded as hex."))},Dt.prototype.validateTypedMessage=function(e,t){return void 0===e.from?t(new Error("Undefined address - from address required to sign typed data.")):void 0===e.data?t(new Error("Undefined data - message required to sign typed data.")):void this.validateSender(e.from,(function(r,n){return r?t(r):n?void t():t(new Error(`Unknown address - unable to sign message for this address: "${e.from}"`))}))},Dt.prototype.validateTypedMessageV3=function(e,t){return void 0===e.from?t(new Error("Undefined address - from address required to sign typed data.")):void 0===e.data?t(new Error("Undefined data - message required to sign typed data.")):void this.validateSender(e.from,(function(r,n){return r?t(r):n?void t():t(new Error(`Unknown address - unable to sign message for this address: "${e.from}"`))}))},Dt.prototype.validateSender=function(e,t){if(!e)return t(null,!1);this.getAccounts((function(r,n){if(r)return t(r);const o=-1!==n.map(Ot).indexOf(e.toLowerCase());t(null,o)}))},Dt.prototype.finalizeAndSubmitTx=function(e,t){const r=this;r.nonceLock.take((function(){Bt([r.fillInTxExtras.bind(r,e),r.signTransaction.bind(r),r.publishTransaction.bind(r)],(function(e,n){if(r.nonceLock.leave(),e)return t(e);t(null,n)}))}))},Dt.prototype.finalizeTx=function(e,t){const r=this;r.nonceLock.take((function(){Bt([r.fillInTxExtras.bind(r,e),r.signTransaction.bind(r)],(function(n,o){if(r.nonceLock.leave(),n)return t(n);t(null,{raw:o,tx:e})}))}))},Dt.prototype.publishTransaction=function(e,t){this.emitPayload({method:"eth_sendRawTransaction",params:[e]},(function(e,r){if(e)return t(e);t(null,r.result)}))},Dt.prototype.estimateGas=function(e,t){Ct(this.engine,e,t)},Dt.prototype.getGasPrice=function(e){this.emitPayload({method:"eth_gasPrice",params:[]},(function(t,r){if(t)return e(t);e(null,r.result)}))},Dt.prototype.fillInTxExtras=function(e,t){const r=this,n=e.from,o={};void 0===e.gasPrice&&(o.gasPrice=r.getGasPrice.bind(r)),void 0===e.nonce&&(o.nonce=r.emitPayload.bind(r,{method:"eth_getTransactionCount",params:[n,"pending"]})),void 0===e.gas&&(o.gas=r.estimateGas.bind(r,function(e){return{from:e.from,to:e.to,value:e.value,data:e.data,gas:e.gas,gasPrice:e.gasPrice,nonce:e.nonce}}(e))),Pt(o,(function(r,n){if(r)return t(r);const o={};n.gasPrice&&(o.gasPrice=n.gasPrice),n.nonce&&(o.nonce=n.nonce.result),n.gas&&(o.gas=n.gas),t(null,It(e,o))}))};const jt=t.inherits,zt=p,Vt=n,qt=I;var Gt=Yt;function Yt(e){this.nonceCache={}}jt(Yt,J),Yt.prototype.handleRequest=function(e,t,r){const n=this;switch(e.method){case"eth_getTransactionCount":var o=qt(e),i=e.params[0].toLowerCase(),a=n.nonceCache[i];return void("pending"===o?a?r(null,a):t((function(e,t,r){if(e)return r();void 0===n.nonceCache[i]&&(n.nonceCache[i]=t),r()})):t());case"eth_sendRawTransaction":return void t((function(t,r,o){if(t)return o();var i=e.params[0];Vt.stripHexPrefix(i),Buffer.from(Vt.stripHexPrefix(i),"hex");var a=new zt(Buffer.from(Vt.stripHexPrefix(i),"hex")),s="0x"+a.getSenderAddress().toString("hex").toLowerCase(),c=Vt.bufferToInt(a.nonce),u=(++c).toString(16);u.length%2&&(u="0"+u),u="0x"+u,n.nonceCache[s]=u,o()}));case"evm_revert":return n.nonceCache={},void t();default:return void t()}};const Jt=X,Zt=v;var $t=class extends Jt{constructor(){super((({blockTracker:e,provider:t,engine:r})=>{const{events:n,middleware:o}=Zt({blockTracker:e,provider:t});return n.on("notification",(e=>r.emit("data",null,e))),o}))}},Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});var Qt=Xt.default=Xt.ERR_NOT_IN_IFRAME=Xt.ERR_CONNECTION_TIMEOUT=Xt.ERR_CONNECTION_DESTROYED=void 0,er="message";Xt.ERR_CONNECTION_DESTROYED="ConnectionDestroyed";Xt.ERR_CONNECTION_TIMEOUT="ConnectionTimeout";Xt.ERR_NOT_IN_IFRAME="NotInIframe";var tr,rr={"http:":"80","https:":"443"},nr=/^(https?:)?\/\/([^/:]+)(:(\d+))?/,or={ERR_CONNECTION_DESTROYED:"ConnectionDestroyed",ERR_CONNECTION_TIMEOUT:"ConnectionTimeout",ERR_NOT_IN_IFRAME:"NotInIframe",Promise:function(){try{return window?window.Promise:null}catch(e){return null}}(),debug:!1},ir=(tr=0,function(){return++tr}),ar=function(){if(or.debug){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).log.apply(e,["[Penpal]"].concat(r))}},sr=function(e){var t=[];return e((function(){t.forEach((function(e){e()}))})),{then:function(e){t.push(e)}}},cr=function(e){return{name:e.name,message:e.message,stack:e.stack}},ur=function(e){var t=new Error;return Object.keys(e).forEach((function(r){return t[r]=e[r]})),t},fr=function(e,t,r,n){var o=t.localName,i=t.local,a=t.remote,s=t.remoteOrigin,c=!1;ar("".concat(o,": Connecting call sender"));n.then((function(){c=!0})),r.reduce((function(e,t){return e[t]=function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(ar("".concat(o,": Sending ").concat(e,"() call")),c){var u=new Error("Unable to send ".concat(e,"() call due ")+"to destroyed connection");throw u.code="ConnectionDestroyed",u}return new or.Promise((function(t,n){var c=ir();i.addEventListener(er,(function r(u){if(u.source===a&&u.origin===s&&"reply"===u.data.penpal&&u.data.id===c){ar("".concat(o,": Received ").concat(e,"() reply")),i.removeEventListener(er,r);var f=u.data.returnValue;u.data.returnValueIsError&&(f=ur(f)),("fulfilled"===u.data.resolution?t:n)(f)}})),a.postMessage({penpal:"call",id:c,methodName:e,args:r},s)}))}}(t),e}),e)},lr=function(e,t,r){var n=e.localName,o=e.local,i=e.remote,a=e.remoteOrigin,s=!1;ar("".concat(n,": Connecting call receiver"));var c=function(e){if(e.source===i&&e.origin===a&&"call"===e.data.penpal){var r=e.data,o=r.methodName,c=r.args,u=r.id;if(ar("".concat(n,": Received ").concat(o,"() call")),o in t){var f=function(e){return function(t){if(ar("".concat(n,": Sending ").concat(o,"() reply")),s)ar("".concat(n,": Unable to send ").concat(o,"() reply due to destroyed connection"));else{var r={penpal:"reply",id:u,resolution:e,returnValue:t};"rejected"===e&&t instanceof Error&&(r.returnValue=cr(t),r.returnValueIsError=!0);try{i.postMessage(r,a)}catch(c){throw"DataCloneError"===c.name&&i.postMessage({penpal:"reply",id:u,resolution:"rejected",returnValue:cr(c),returnValueIsError:!0},a),c}}}};new or.Promise((function(e){return e(t[o].apply(t,c))})).then(f("fulfilled"),f("rejected"))}}};o.addEventListener(er,c),r.then((function(){s=!0,o.removeEventListener(er,c)}))};or.connectToChild=function(e){var t,r=e.url,n=e.appendTo,o=e.methods,i=void 0===o?{}:o,a=e.timeout,s=new sr((function(e){t=e})),c=window,u=document.createElement("iframe");(n||document.body).appendChild(u),s.then((function(){u.parentNode&&u.parentNode.removeChild(u)}));var f=u.contentWindow||u.contentDocument.parentWindow,l=function(e){var t,r,n,o=document.location,i=nr.exec(e);i?(t=i[1]?i[1]:o.protocol,r=i[2],n=i[4]):(t=o.protocol,r=o.hostname,n=o.port);var a=n&&n!==rr[t]?":".concat(n):"";return"".concat(t,"//").concat(r).concat(a)}(r);return{promise:new or.Promise((function(e,n){var o;void 0!==a&&(o=setTimeout((function(){var e=new Error("Connection to child timed out after ".concat(a,"ms"));e.code="ConnectionTimeout",n(e),t()}),a));var h,d,p={},g=function(t){if(t.source===f&&t.origin===l&&"handshake"===t.data.penpal){ar("Parent: Received handshake, sending reply"),t.source.postMessage({penpal:"handshake-reply",methodNames:Object.keys(i)},t.origin);var r={localName:"Parent",local:c,remote:f,remoteOrigin:t.origin};d&&d();var n=new sr((function(e){s.then(e),d=e}));lr(r,i,n),h&&h.forEach((function(e){delete p[e]})),h=t.data.methodNames,fr(p,r,h,s),clearTimeout(o),e(p)}};c.addEventListener(er,g),s.then((function(){c.removeEventListener(er,g);var e=new Error("Connection destroyed");e.code="ConnectionDestroyed",n(e)})),ar("Parent: Loading iframe"),u.src=r})),iframe:u,destroy:t}},or.connectToParent=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.parentOrigin,n=void 0===r?"*":r,o=t.methods,i=void 0===o?{}:o,a=t.timeout;if(window===window.top){var s=new Error("connectToParent() must be called within an iframe");throw s.code="NotInIframe",s}var c=new sr((function(t){e=t})),u=window,f=u.parent,l=new or.Promise((function(t,r){var o;void 0!==a&&(o=setTimeout((function(){var t=new Error("Connection to parent timed out after ".concat(a,"ms"));t.code="ConnectionTimeout",r(t),e()}),a));var s=function e(r){if(("*"===n||n===r.origin)&&r.source===f&&"handshake-reply"===r.data.penpal){ar("Child: Received handshake reply"),u.removeEventListener(er,e);var a={localName:"Child",local:u,remote:f,remoteOrigin:r.origin},s={};lr(a,i,c),fr(s,a,r.data.methodNames,c),clearTimeout(o),t(s)}};u.addEventListener(er,s),c.then((function(){u.removeEventListener(er,s);var e=new Error("Connection destroyed");e.code="ConnectionDestroyed",r(e)})),ar("Child: Sending handshake"),f.postMessage({penpal:"handshake",methodNames:Object.keys(i)},n)}));return{promise:l,destroy:e}};var hr=or;function dr(e,t){var r="string"==typeof e?Object.assign({},pr[e]):e;if("object"!=typeof r)throw new Error("[Portis] illegal 'network' parameter. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(!r.nodeUrl)throw new Error("[Portis] 'nodeUrl' is required. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(t&&!r.gasRelayHubAddress)throw new Error("[Portis] can't find default gas relay hub for "+e);return"string"!=typeof e||t||delete r.gasRelayHubAddress,r}Qt=Xt.default=hr;var pr={mainnet:{nodeUrl:"https://mainnet.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"1",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},ropsten:{nodeUrl:"https://ropsten.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"3",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},rinkeby:{nodeUrl:"https://rinkeby.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"4",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},goerli:{nodeUrl:"https://goerli.prylabs.net",chainId:"5"},ubiq:{nodeUrl:"https://rpc1.ubiqscan.io",chainId:"8"},thundercoreTestnet:{nodeUrl:"https://testnet-rpc.thundercore.com:8544",chainId:"18"},orchid:{nodeUrl:"https://public-node.rsk.co",chainId:"30"},orchidTestnet:{nodeUrl:"https://public-node.testnet.rsk.co",chainId:"31"},kovan:{nodeUrl:"https://kovan.infura.io/v3/faa4639b090f46499f29d894da0551a0",chainId:"42",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},classic:{nodeUrl:"https://ethereumclassic.network",chainId:"61"},sokol:{nodeUrl:"https://sokol.poa.network",chainId:"77"},core:{nodeUrl:"https://core.poa.network",chainId:"99"},xdai:{nodeUrl:"https://dai.poa.network",chainId:"100",gasRelayHubAddress:"0xD216153c06E857cD7f72665E0aF1d7D82172F494"},thundercore:{nodeUrl:"https://mainnet-rpc.thundercore.com",chainId:"108"},fuse:{nodeUrl:"https://rpc.fusenet.io",chainId:"122"},lightstreams:{nodeUrl:"https://node.mainnet.lightstreams.io",chainId:"163"},matic:{nodeUrl:"https://rpc-mainnet.matic.network",chainId:"137"},maticMumbai:{nodeUrl:"https://rpc-mumbai.matic.today",chainId:"80001"},maticAlpha:{nodeUrl:"https://alpha.ethereum.matic.network",chainId:"4626"},maticTestnet:{nodeUrl:"https://testnet2.matic.network",chainId:"8995"}},gr=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,s)}c((n=n.apply(e,t||[])).next())}))},yr=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},vr=require("ethereumjs-util"),mr=vr.addHexPrefix,wr=vr.stripHexPrefix,br=vr.BN;function _r(e,t){return gr(this,void 0,void 0,(function(){var r,n,o,i,a;return yr(this,(function(s){switch(s.label){case 0:return[4,e.getBlockByNumber("latest",!1)];case 1:return r=s.sent(),[4,xr(e,t,r.gasLimit)];case 2:if(n=s.sent(),o=n.safeGas,i=n.simpleSend,a=n.gasLimitSpecified,i||a)return[2,o];s.label=3;case 3:return s.trys.push([3,5,,6]),[4,Er(e,t,r.gasLimit,o)];case 4:return[2,s.sent()];case 5:return s.sent(),[2,o];case 6:return[2]}}))}))}function xr(e,t,r){return gr(this,void 0,void 0,(function(){var n,o,i;return yr(this,(function(a){switch(a.label){case 0:return Boolean(t.gas)?[2,{safeGas:t.gas,simpleSend:!1,gasLimitSpecified:!0}]:(n=t.to,Boolean(n)?[4,e.getCode(n)]:[3,2]);case 1:if(o=a.sent(),!o||"0x"===o||"0x0"===o){if(t.data)throw new Error("Trying to call a function on a non-contract address");return[2,{safeGas:"0x5208",simpleSend:!0,gasLimitSpecified:!1}]}a.label=2;case 2:return i=Tr(r),s=i,c=20,u=new br(19),f=new br(c),[2,{safeGas:Ar(s.mul(u).div(f)),simpleSend:!1,gasLimitSpecified:!1}]}var s,c,u,f}))}))}function Er(e,t,r,n){return gr(this,void 0,void 0,(function(){var o;return yr(this,(function(i){switch(i.label){case 0:return t.gas=n,o=mr,[4,e.estimateGas(t)];case 1:return[2,kr(o.apply(void 0,[i.sent()]),r)]}}))}))}function kr(e,t){var r=Tr(e),n=Tr(t).muln(.9),o=r.muln(1.5);return r.gt(n)?Ar(r):o.lt(n)?Ar(o):Ar(n)}function Tr(e){return new br(wr(e),16)}function Ar(e){return mr(e.toString(16))}var Br=function(){function e(e){this.provider=e}return e.prototype.getBlockByNumber=function(e,t){return this.sendAsync("eth_getBlockByNumber",e,t)},e.prototype.getCode=function(e,t){return void 0===t&&(t="latest"),this.sendAsync("eth_getCode",e,t)},e.prototype.estimateGas=function(e){return this.sendAsync("eth_estimateGas",e)},e.prototype.sendAsync=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return new Promise((function(n,o){t.provider.sendAsync({id:42,jsonrpc:"2.0",method:e,params:r},(function(e,t){e?o(e):n(t.result)}))}))},e}(),Pr=!1;function Sr(){return new Promise((function(e){Pr?e():["loaded","interactive","complete"].indexOf(document.readyState)>-1?(Pr=!0,e()):window.addEventListener("load",(function(){Pr=!0,e()}),!1)}))}var Ur={exports:{}};var Mr={Blockchain:class{constructor(e,t){this.name=e,this.netID=t}toJSON(){return JSON.parse('{ "name":"'+this.name+'", "netID":"'+this.netID+'"}')}}};var Ir={dispatchNodeURL:"https://dispatch.pokt.network",dispatchPath:"/v1/dispatch",reportPath:"/v1/report",relayPath:"/v1/relay/"};const Rr=P,Cr=Ir;var Nr={Node:class{constructor(e,t,r){this.network=e,this.netID=t;var n=r.split(":");this.ip=n[0],this.port=n[1],r.includes("https://")||r.includes("http://")?this.ipPort=r:"443"===this.port||443===this.port?this.ipPort="https://"+r:this.ipPort="http://"+r}isValid(){for(var e in this)if(!this.hasOwnProperty(e)||""==this[e])return!1;return!0}isEqual(e,t){return this.netID==e.toString()&&this.network==t.toString()}async sendRelay(e,t){try{const o=Rr.create({baseURL:this.ipPort,timeout:e.configuration.requestTimeOut,headers:{"Content-Type":"application/json"}});var r=await o.post(Cr.relayPath,e.toJSON());if(200==r.status&&null!=r.data){var n=r.data;return t?void t(n,null):n}return t?void t(null,new Error("Failed to send relay with error: "+r.data)):new Error("Failed to send relay with error: "+r.data)}catch(o){return t?void t(null,new Error("Failed to send relay with error: "+o)):new Error("Failed to send relay with error: "+o)}}}};const Lr=P,Dr=Nr.Node,Or=Ir;var Hr={Dispatch:class{constructor(e){this.configuration=e,this.axiosInstance=Lr.create({baseURL:Or.dispatchNodeURL,path:Or.dispatchPath,timeout:this.configuration.requestTimeOut,headers:{"Content-Type":"application/json"}})}blockchainsJSON(){var e=[];return this.configuration.blockchains.forEach((t=>{e.push(t)})),e}async retrieveServiceNodes(e){try{var t;if(null!=(t=await this.axiosInstance.post(Or.dispatchPath,{DevID:this.configuration.devID,Blockchains:this.blockchainsJSON()}))&&200==t.status&&null!=t.data){var r=this.parseDispatchResponse(t.data);return e?void e(r,null):r}return e?void e(null,new Error("Failed to retrieve service nodes with error: "+t.data)):new Error("Failed to retrieve service nodes with error: "+t.data)}catch(n){return e?void e(null,new Error("Failed to retrieve service nodes with error: "+n)):new Error("Failed to retrieve service nodes with error: "+n)}}parseDispatchResponse(e){try{var t=[];if(Array.isArray(e))e.forEach((e=>{var r=e.name,n=e.netid;e.ips&&e.ips.forEach((e=>{var o=new Dr(r,n,e);t.push(o)}))}));else{var r=e.name,n=e.netid;e.ips&&e.ips.forEach((e=>{var o=new Dr(r,n,e);t.push(o)}))}return t}catch(o){return new Error("Failed to parsed service nodes with error: "+o)}}}};var Fr={Relay:class{constructor(e,t,r,n){this.blockchain=e,this.netID=t,this.data=r,this.configuration=n}toJSON(){return{Blockchain:this.blockchain,NetID:this.netID,Data:this.data,DevID:this.configuration.devID}}isValid(){for(var e in this)if(!this.hasOwnProperty(e)||""==this[e])return!1;return!0}}};const Kr=P,Wr=Ir;var jr={Report:class{constructor(e,t,r){this.ip=e,this.message=t,this.configuration=r}toJSON(){return{IP:this.ip,Message:this.message}}isValid(){for(var e in this)if(!this.hasOwnProperty(e)||""==this[e])return!1;return!0}async send(e){const t=Kr.create({baseURL:Wr.dispatchNodeURL,timeout:this.configuration.requestTimeOut,headers:{"Content-Type":"application/json"}});var r=await t.post(Wr.reportPath,this.toJSON());return 200==r.status&&null!=r.data?e?void e(null,r.data):r.data:e?void e(new Error("Failed to send report with error: "+r.data)):new Error("Failed to send report with error: "+r.data)}}};var zr={Wallet:class{constructor(e,t,r,n,o){this.address=e,this.privateKey=t,this.network=r,this.networkID=n,this.data=o}}};!function(e){e.exports=Object.assign(e.exports,Mr,Hr,Nr,Fr,jr,zr)}(Ur);const Vr=Ur.exports,qr=Vr.Blockchain,Gr=Vr.Dispatch,Yr=Vr.Relay,Jr=Vr.Report;class Zr{constructor(e,t,r,n){this.devID=e,this.blockchains=t,this.maxNodes=r||5,this.nodes=[],this.requestTimeOut=n||1e4,this.dispatch=null}nodesIsEmpty(){return null==this.nodes||0==this.nodes.length}}const $r=Ur.exports;var Xr={Pocket:class{constructor(e){var t=[];if(null==e.devID||null==e.networkName||null==e.netIDs)return new Error("Invalid number of arguments");if(Array.isArray(e.netIDs))e.netIDs.forEach((r=>{var n=new qr(e.networkName,r);t.push(n.toJSON())}));else{var r=new qr(e.networkName,e.netIDs);t.push(r.toJSON())}this.configuration=new Zr(e.devID,t,e.maxNodes||5,e.requestTimeOut||1e4)}createRelay(e,t,r){return new Yr(e,t,"string"==typeof r?r:JSON.stringify(r),this.configuration)}createReport(e,t){return new Jr(e,t,this.configuration)}getDispatch(){return null==this.dispatch&&(this.dispatch=new Gr(this.configuration)),this.dispatch}async getNode(e,t){try{var r=[];if(this.configuration.nodesIsEmpty()){var n=await this.retrieveNodes();if(n instanceof Error==1)throw n;this.configuration.nodes=n}return this.configuration.nodes.forEach((n=>{n.isEqual(e,t)&&r.push(n)})),r.length<=0?null:r[Math.floor(Math.random()*r.length)]}catch(o){return null}}async sendReport(e,t){try{if(null==e)throw new Error("Report is null");if(!e.isValid())throw new Error("One or more Report properties are empty.");var r=await e.send();return r instanceof Error==0?t?void t(null,r):r:t?void t(r):r}catch(n){return t?void t(n):n}}async sendRelay(e,t){try{if(null==e||null==e.data)return t?void t(new Error("Relay is null or data field is missing")):new Error("Relay is null or data field is missing");if(!e.isValid())return t?void t(new Error("Relay is missing a property, please verify all properties.")):new Error("Relay is missing a property, please verify all properties.");var r=await this.getNode(e.netID,e.blockchain);if(null==r)return t?void t(new Error("Node is empty.")):new Error("Node is empty.");var n=await r.sendRelay(e);return n instanceof Error==0?t?void t(null,n):n:t?void t(n):n}catch(o){return t?void t(new Error("Failed to send relay with error: "+o)):new Error("Failed to send relay with error: "+o)}}async retrieveNodes(e){try{var t=this.getDispatch(),r=await t.retrieveServiceNodes();return r instanceof Error==0&&0!=r.length?(this.configuration.nodes=r,e?void e(null,r):r):e?void e(new Error("Failed to retrieve a list of nodes."),null):new Error("Failed to retrieve a list of nodes.")}catch(n){return e?void e(new Error("Failed to retrieve a list of nodes with error: "+n),null):new Error("Failed to retrieve a list of nodes with error: "+n)}}},Wallet:$r.Wallet,Relay:$r.Relay},Qr=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(a,s)}c((n=n.apply(e,t||[])).next())}))},en=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},tn=["email","reputation"],rn=document.createElement("iframe");rn.className="por_portis-iframe",rn.style.width="0",rn.style.height="0",rn.style.border="none",rn.style.position="absolute",rn.style.top="-999px",rn.style.left="-999px",rn.src="https://widget.portis.io",Sr().then((function(){document.getElementsByClassName("por_portis-iframe").length&&console.warn("Portis script was already loaded. This might cause unexpected behavior. If loading with a <script> tag, please make sure that you only load it once."),document.body.appendChild(rn)}));var nn=function(){function e(e,t,r){void 0===r&&(r={}),this._widgetUrl="https://widget.portis.io",function(){var e="localhost"===location.hostname||"127.0.0.1"===location.hostname,t="https:"===location.protocol;if(!e&&!t)throw"[Portis] Access to the WebCrypto API is restricted to secure origins.\nIf this is a development environment please use http://localhost:"+location.port+" instead.\nOtherwise, please use an SSL certificate."}(),this._checkIfWidgetAlreadyInitialized(),this._validateParams(e,t,r),this.config={dappId:e,network:dr(t,r.gasRelay),version:"2.0.0-beta.59",scope:r.scope,registerPageByDefault:r.registerPageByDefault},this.widget=this._initWidget(),this.provider=this._initProvider(r)}return e.prototype.changeNetwork=function(e,t){var r=dr(e,t);this.clearSubprovider(Gt),this.clearSubprovider(le),this.config.network=r},e.prototype.setDefaultEmail=function(e){this.config.defaultEmail=e},e.prototype.showPortis=function(){return Qr(this,void 0,void 0,(function(){return en(this,(function(e){switch(e.label){case 0:return[4,this.widget];case 1:return[2,e.sent().communication.showPortis(this.config)]}}))}))},e.prototype.logout=function(){return Qr(this,void 0,void 0,(function(){return en(this,(function(e){switch(e.label){case 0:return[4,this.widget];case 1:return[2,e.sent().communication.logout()]}}))}))},e.prototype.onLogin=function(e){this._onLoginCallback=e},e.prototype.onLogout=function(e){this._onLogoutCallback=e},e.prototype.onActiveWalletChanged=function(e){this._onActiveWalletChangedCallback=e},e.prototype.onError=function(e){this._onErrorCallback=e},e.prototype.getExtendedPublicKey=function(e,t){return void 0===e&&(e="m/44'/60'/0'/0/0"),void 0===t&&(t="Ethereum"),Qr(this,void 0,void 0,(function(){return en(this,(function(r){switch(r.label){case 0:return[4,this.widget];case 1:return[2,r.sent().communication.getExtendedPublicKey(e,t,this.config)]}}))}))},e.prototype.importWallet=function(e){return Qr(this,void 0,void 0,(function(){return en(this,(function(t){switch(t.label){case 0:return[4,this.widget];case 1:return[2,t.sent().communication.importWallet(e,this.config)]}}))}))},e.prototype.isLoggedIn=function(){return Qr(this,void 0,void 0,(function(){return en(this,(function(e){switch(e.label){case 0:return[4,this.widget];case 1:return[2,e.sent().communication.isLoggedIn()]}}))}))},e.prototype.signBitcoinTransaction=function(e){return Qr(this,void 0,void 0,(function(){return en(this,(function(t){switch(t.label){case 0:return[4,this.widget];case 1:return[2,t.sent().communication.signBitcoinTransaction(e,this.config)]}}))}))},e.prototype.showBitcoinWallet=function(e){return void 0===e&&(e="m/49'/0'/0'/0/0"),Qr(this,void 0,void 0,(function(){return en(this,(function(t){switch(t.label){case 0:return[4,this.widget];case 1:return[2,t.sent().communication.showBitcoinWallet(e,this.config)]}}))}))},e.prototype._checkIfWidgetAlreadyInitialized=function(){document.getElementsByClassName("por_portis-container").length&&console.warn("An instance of Portis was already initialized. This is probably a mistake. Make sure that you use the same Portis instance throughout your app.")},e.prototype._validateParams=function(e,t,r){if(!e)throw new Error("[Portis] 'dappId' is required. Get your dappId here: https://dashboard.portis.io");if(!t)throw new Error("[Portis] 'network' is required. Read more about it here: https://docs.portis.io/#/configuration?id=network");if(r.scope){if(!Array.isArray(r.scope))throw new Error("[Portis] 'scope' must be an array. Read more about it here: https://docs.portis.io/#/configuration?id=scope");if(r.scope.filter((function(e){return tn.indexOf(e)<0})).length>0)throw new Error("[Portis] invalid 'scope' parameter. Read more about it here: https://docs.portis.io/#/configuration?id=scope")}if(void 0!==r.registerPageByDefault&&"boolean"!=typeof r.registerPageByDefault)throw new Error("[Portis] invalid 'registerPageByDefault' parameter, must be a boolean. Read more about it here: https://docs.portis.io/#/configuration?id=registerPageByDefault");r.staging&&(console.warn("Please note: you are using the Portis STAGING environment."),this._widgetUrl="https://widget-staging.portis.io")},e.prototype._initWidget=function(){return Qr(this,void 0,void 0,(function(){var e,t,r,n,o;return en(this,(function(i){switch(i.label){case 0:return[4,Sr()];case 1:return i.sent(),document.body.contains(rn)&&document.body.removeChild(rn),(e=document.createElement("style")).innerHTML="\n.por_portis-container {\n  position: fixed;\n  width: 0px;\n  height: 0px;\n  top: 0px;\n  right: 0px;\n  z-index: 2147483647;\n}\n\n@media (max-width: 576px) {\n  .por_portis-container {\n    bottom: 0;\n    top: auto;\n  }\n}\n\n.por_portis-widget-frame {\n  position: fixed;\n  width: 375px;\n  height: 0;\n  top: 20px;\n  right: 20px;\n  box-shadow: 0 5px 40px rgba(0,0,0,.16);\n  border-radius: 8px;\n  overflow: hidden;\n  z-index: 2147483000;\n}\n\n@media (max-width: 576px) {\n  .por_portis-widget-frame {\n    bottom: 0;\n    top: auto;\n    width: 100%;\n    right: 0;\n    left: 0;\n    border-bottom-left-radius: 0;\n    border-bottom-right-radius: 0;\n  }\n}\n",(t=document.createElement("div")).className="por_portis-container",(r=document.createElement("div")).id="portis-container-"+Date.now(),r.className="por_portis-widget-frame",t.appendChild(r),document.body.appendChild(t),document.head.appendChild(e),(n=Qt.connectToChild({url:this._widgetUrl,appendTo:document.getElementById(r.id),methods:{setHeight:this._setHeight.bind(this),getWindowSize:this._getWindowSize.bind(this),onLogin:this._onLogin.bind(this),onLogout:this._onLogout.bind(this),onActiveWalletChanged:this._onActiveWalletChanged.bind(this),onError:this._onError.bind(this)}})).iframe.style.position="absolute",n.iframe.style.height="100%",n.iframe.style.width="100%",n.iframe.style.border="0 transparent",[4,n.promise];case 2:return(o=i.sent()).retrieveSession(this.config),[2,{communication:o,iframe:n.iframe,widgetFrame:r}]}}))}))},e.prototype._initProvider=function(e){var t=this,r=new q,n=new Br(r);if(r.send=function(e,n){if("string"==typeof e)return new Promise((function(t,o){r.sendAsync({jsonrpc:"2.0",id:42,method:e,params:n||[]},(function(e,r){e?o(e):t(r.result)}))}));if(!n){var o=null;switch(e.method){case"eth_accounts":case"eth_coinbase":o=t._selectedAddress?[t._selectedAddress]:[];break;case"net_version":o=t._network;break;case"eth_uninstallFilter":r.sendAsync(e,(function(e){return e})),o=!0;break;default:var i="The Portis Web3 object does not support synchronous methods like "+e.method+" without a callback parameter.";throw new Error(i)}return{id:e.id,jsonrpc:e.jsonrpc,result:o}}r.sendAsync(e,n)},r.addProvider(new de({web3_clientVersion:"Portis/v"+this.config.version+"/javascript",net_listening:!0,eth_hashrate:"0x00",eth_mining:!1,eth_syncing:!0})),r.addProvider(new le),r.addProvider(new $t),r.addProvider(new ve),r.addProvider(new Gt),r.addProvider({setEngine:function(e){return e},handleRequest:function(e,r,n){return Qr(t,void 0,void 0,(function(){return en(this,(function(t){return e.id||(e.id=42),r(),[2]}))}))}}),r.addProvider(new Lt({getAccounts:function(e){return Qr(t,void 0,void 0,(function(){var t,r,n;return en(this,(function(o){switch(o.label){case 0:return[4,this.widget];case 1:return[4,o.sent().communication.getAccounts(this.config)];case 2:return t=o.sent(),r=t.error,n=t.result,!r&&n&&(this._selectedAddress=n[0]),e(r,n),[2]}}))}))},signTransaction:function(e,r){return Qr(t,void 0,void 0,(function(){var t,n,o;return en(this,(function(i){switch(i.label){case 0:return[4,this.widget];case 1:return[4,i.sent().communication.signTransaction(e,this.config)];case 2:return t=i.sent(),n=t.error,o=t.result,r(n,o),[2]}}))}))},signMessage:function(e,r){return Qr(t,void 0,void 0,(function(){var t,n,o,i,a;return en(this,(function(s){switch(s.label){case 0:return[4,this.widget];case 1:return t=s.sent().communication,n=Object.assign({},e,{messageStandard:"signMessage"}),[4,t.signMessage(n,this.config)];case 2:return o=s.sent(),i=o.error,a=o.result,r(i,a),[2]}}))}))},signPersonalMessage:function(e,r){return Qr(t,void 0,void 0,(function(){var t,n,o,i,a;return en(this,(function(s){switch(s.label){case 0:return[4,this.widget];case 1:return t=s.sent().communication,n=Object.assign({},e,{messageStandard:"signPersonalMessage"}),[4,t.signMessage(n,this.config)];case 2:return o=s.sent(),i=o.error,a=o.result,r(i,a),[2]}}))}))},signTypedMessage:function(e,r){return Qr(t,void 0,void 0,(function(){var t,n,o,i,a;return en(this,(function(s){switch(s.label){case 0:return[4,this.widget];case 1:return t=s.sent().communication,n=Object.assign({},e,{messageStandard:"signTypedMessage"}),[4,t.signMessage(n,this.config)];case 2:return o=s.sent(),i=o.error,a=o.result,r(i,a),[2]}}))}))},signTypedMessageV3:function(e,r){return Qr(t,void 0,void 0,(function(){var t,n,o,i,a;return en(this,(function(s){switch(s.label){case 0:return[4,this.widget];case 1:return t=s.sent().communication,n=Object.assign({},e,{messageStandard:"signTypedMessageV3"}),[4,t.signMessage(n,this.config)];case 2:return o=s.sent(),i=o.error,a=o.result,r(i,a),[2]}}))}))},estimateGas:function(e,r){return Qr(t,void 0,void 0,(function(){var t;return en(this,(function(o){switch(o.label){case 0:return[4,_r(n,e)];case 1:return t=o.sent(),r(null,t),[2]}}))}))},getGasPrice:function(e){return Qr(t,void 0,void 0,(function(){return en(this,(function(t){return e(null,""),[2]}))}))}})),e.pocketDevId){var o=new Xr.Pocket({devID:e.pocketDevId,networkName:"ETH",netIDs:[this.config.network.chainId]});r.addProvider({setEngine:function(e){return e},handleRequest:function(e,n,i){return Qr(t,void 0,void 0,(function(){var t,n,a;return en(this,(function(s){switch(s.label){case 0:return[4,o.sendRelay(new Xr.Relay("ETH",this.config.network.chainId,JSON.stringify(e),o.configuration))];case 1:if((t=s.sent())instanceof Error||!t)a=t||new Error("Unknown error"),n=null;else try{n=JSON.parse(t).result,a=null}catch(c){n=null,a=c}return"net_version"===e.method&&(this._network=n,r.networkVersion=this._network),i(a,n),[2]}}))}))}})}else r.addProvider({setEngine:function(e){return e},handleRequest:function(e,n,o){return Qr(t,void 0,void 0,(function(){var t,n,i;return en(this,(function(a){switch(a.label){case 0:return[4,this.widget];case 1:return[4,a.sent().communication.relay(e,this.config)];case 2:return t=a.sent(),n=t.error,i=t.result,"net_version"===e.method&&(this._network=i,r.networkVersion=this._network),o(n,i),[2]}}))}))}});return r.enable=function(){return new Promise((function(e,t){r.sendAsync({method:"eth_accounts"},(function(r,n){r?t(r):e(n.result)}))}))},r.isConnected=function(){return!0},r.isPortis=!0,r.on("error",(function(e){e&&e.message&&e.message.includes("PollingBlockTracker")?console.warn("If you see this warning constantly, there might be an error with your RPC node."):console.error(e)})),r.start(),r},e.prototype._setHeight=function(e){return Qr(this,void 0,void 0,(function(){return en(this,(function(t){switch(t.label){case 0:return[4,this.widget];case 1:return t.sent().widgetFrame.style.height=e+"px",[2]}}))}))},e.prototype._getWindowSize=function(){var e=document.getElementsByTagName("body")[0];return{width:window.innerWidth||document.documentElement.clientWidth||e.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||e.clientHeight}},e.prototype._onLogin=function(e,t,r){this._onLoginCallback&&this._onLoginCallback(e,t,r)},e.prototype._onLogout=function(){this._selectedAddress="",this._onLogoutCallback&&this._onLogoutCallback()},e.prototype._onActiveWalletChanged=function(e){this._onActiveWalletChangedCallback&&this._onActiveWalletChangedCallback(e)},e.prototype._onError=function(e){this._onErrorCallback&&this._onErrorCallback(e)},e.prototype.clearSubprovider=function(e){var t=this.provider._providers.find((function(t){return t instanceof e}));this.provider.removeProvider(t),this.provider.addProvider(new e)},e}();export{nn as default};
